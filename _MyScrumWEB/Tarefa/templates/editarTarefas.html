{% extends 'base.html' %}{% load static %}

{% block title %} Editar Tarefas {{tarefa.id_tarefa}} {% endblock %}

{% block head %}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>

<!-- CSS da Pagina -->
<link href="{% static 'Tarefa/css/editarTarefas.css' %}" rel="stylesheet">

<!--Usando arquivos da app home para não duplicar arquivos-->

<!-- Script para o funciomento dos DatePickers -->
<script src="{% static 'Home/datepicker/js/bootstrap-datepicker.min.js' %}"></script>
<script src="{% static 'Home/datepicker/js/bootstrap-datetimepicker.min.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment-with-locales.min.js" integrity="sha512-LGXaggshOkD/at6PFNcp2V2unf9LzFq6LE+sChH7ceMTDP0g2kn6Vxwgg7wkPP7AAtX+lmPqPdxB47A0Nz0cMQ==" crossorigin="anonymous"></script>
<script type="text/javascript" src="{% static 'Tarefa/js/datetimepicker.js' %}"></script>

<!-- Script para reconher o PT-BR do DatePickers-->
<script src="{% static 'Home/datepicker/js/bootstrap-datepicker.pt-BR.min.js' %}" charset="UTF-8"></script>

<!-- CSS do DatePickers -->
<link id="bsdp-css" href="{% static 'Home/datepicker/css/bootstrap-datepicker3.min.css' %}" rel="stylesheet">
<link href="{% static 'Home/datepicker/css/bootstrap-datetimepicker.min.css' %}" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="{% static 'Tarefa/css/datetimepicker.css' %}" rel="stylesheet" type="text/css"/>

{% endblock %}

{% block content %}

<div class="load" id="load">
    <i class="fa fa-cog fa-spin fa-10x fa-fw"></i><span class="sr-only">Loading...</span>
</div>

{% if messages %}
{% for message in messages %}
<div id="alert-tarefa" class="alert alert-{{message.extra_tags}} alert-dismissible fade show" role="alert">
    <center>{{ message }}</center>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
</div>

{% endfor %}
{% endif %}

<div class="conteudo" id="conteudo">
    <div class="div-cadastro-form">
        <form class="label" action="{% url 'Tarefa:editar' tarefa.id_tarefa %}" method="post">
            {% csrf_token %}

            <div id="blocoConteudo">

                <!-- Tarefa -->
                <div class="fTarefa" id="fTarefa">
                    <div class="row">
                        <div class="col-2" id="id">
                            <label for="id_tarefa">ID:</label>
                            <input type="text" value="{{tarefa.id_tarefa}}" id="id_tarefa" name="id_tarefa"
                                readonly="“true”" />
                        </div>

                        <div class="col" id="atualizado">
                            <p>Atualizado por {{tarefa.id_update.nome}} em {{tarefa.last_update}}</p>
                        </div>

                        <div class="col-1 d-flex justify-content-center align-items-center">
                            <a id="redireciona-mae" href="{{tarefa.id_juridico}}" target="_blank" style="display: none;">Mãe</a>
                        </div>

                        <div hidden>
                            {{form.id_update}}
                        </div>
                        <div hidden>
                            {{form.id_pessoa}}
                        </div>
                        <div hidden>
                            {{form.id_empresa}}
                        </div>
                        <div hidden>
                            {{form.id_status}}
                        </div>
                        <div hidden>
                            {{form.id_filho}}
                        </div>
                    </div>

                    <div class="row" id="descri">
                        <div class="col">
                            <label for="id_descri">*Descrição:</label>
                            <div class="input-group">
                                <textarea name="descri" rows="4" required="" id="id_descri" value=""
                                    maxlength="150">{{tarefa.descri}}</textarea>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col" id="prioridade">
                            <label for="id_stats">*Prioridade: </label>
                            <div class="input-group bs-select">
                                {{form.prioridade}}
                            </div>
                        </div>
                        <div class="col" id="status">
                            <label for="id_stats">*Status: </label>
                            <div class="input-group bs-select">
                                {{form.stat}}
                            </div>
                        </div>
                        <div class="col" id="tamanho">
                            <label for="id_tamanho" data-toggle="modal" data-target="#modalTamanho">*Tamanho: </label>
                            <div class="input-group bs-select">
                                {{ form.id_tamanho }}
                            </div>
                        </div>

                        <div class="col" id="porcentagem">
                            <label for="id_porcentagem">*Porcentagem:</label>
                            <div class="input-group">
                                {{ form.porcentagem }}
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-4 d-flex">
                            <div id="calendario" class="mr-1">
                                <label for="id_bool_calendario">Calendário:</label>
                                <div class="input-group bs-select">
                                    {{ form.calendario }}
                                </div>
                            </div>
                            <div id="data_calendario">
                                <label for="id_data_calendario">Data Calendário:</label>
                                <div class="input-group bs-select">
                                    <div id="id_data_calendario"></div>
                                    <input type="hidden" id="result" name="data_calendario" value="{{tarefa.data_calendario}}" />
                                </div>
                            </div>
                        </div>
                        <div class="col-2" id="dataInicial">
                            <label for="id_data_ini">*Data inicial:</label>
                            <div class="input-group date">
                                <div class="input-group-icon">
                                    {{ form.data_ini }}
                                </div>
                            </div>
                        </div>
                        <div id="dataReal" style="display: none;">
                            <label for="id_data_real">*Data real:</label>
                            <div class="input-group">
                                <div class="input-group-icon">
                                    {{ form.data_real }}
                                </div>
                            </div>
                        </div>
                        <div class="col-2" id="prazo">
                            <label for="id_prazo">*Prazo:</label>
                            <div class="input-group bs-select">
                                <span id="prazoTarefa" style="display: none;">{{tarefa.prazo}}</span>
                                <select type="text" name="prazo" id="id_prazo"></select>
                            </div>
                        </div>
                        <div class="col-2" id="dataFinalizacao">
                            <label for="id_data_finalizacao">*Data fim:</label>
                            <div class="input-group">
                                <div class="input-group-icon">
                                    {{ form.data_finalizacao }}
                                </div>
                            </div>
                        </div>
                        <div class="col-2" id="dataFinal">
                            <label for="id_data_fim">*Data fim real:</label>
                            <div class="input-group">
                                <div class="input-group-icon">
                                    {{ form.data_fim }}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col" id="departamento">
                            <label for="id_departamento">*Departamento:</label>
                            <div class="input-group bs-select">
                                {{ form.id_departamento }}
                            </div>
                        </div>
                        <div class="col" id="centroCusto">
                            <label for="id_centro_custo">*Centro de custo:</label>
                            <div class="input-group bs-select">
                                {{ form.id_centro_custo }}
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col" id="etapa">
                            <label id="label-etapa" for="etapa">Etapa:</label>
                            <div class="input-group bs-select">
                                <select name="etapa" id="id_etapa" class="custom-select form-control form-control-sm">
                                    <option value>---------</option>
                                    {% for etapa in etapas %} {% if tarefa.id_centro_custo == etapa.id_cc %} {% if tarefa.etapa == etapa %}
                                    <option value="{{etapa.id_etapa}}" selected>{{ etapa.etapa }}</option>
                                    {% else %}
                                    <option value="{{etapa.id_etapa}}">{{ etapa.etapa }}</option>
                                    {% endif %} {% endif %} {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col" id="subEtapa">
                            <label id="label-subetapa" for="subetapa">SubEtapa:</label>
                            <div class="input-group bs-select">
                                <select name="subetapa" id="id_subetapa"
                                    class="custom-select form-control form-control-sm">
                                    <option value>---------</option>
                                    {% for subetapa in subetapas %} {% if tarefa.etapa == subetapa.id_etapa %} 
                                        {% if tarefa.subetapa == subetapa %}
                                        <option value="{{subetapa.id_sub_etapas}}" selected>{{ subetapa.sub_etapa }}
                                        </option>
                                        {% else %}
                                        <option value="{{subetapa.id_sub_etapas}}">{{ subetapa.sub_etapa }}</option>
                                        {% endif %} {% endif %} {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col" id="autoridade">
                            <label for="autoridade">*Autoridade:</label>
                            <div class="input-group bs-select">
                                {{ form.autoridade }}
                            </div>
                        </div>
                        <div class="col" id="responsavel">
                            <label for="responsavel">*Responsável:</label>
                            <div class="input-group bs-select">
                                {{ form.responsavel }}
                            </div>
                        </div>
                        <div class="col" id="checado">
                            <label for="checado">Checado:</label>
                            <div class="input-group bs-select">
                                {{ form.checado }}
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col" id="statusPendencia">
                            <label for="id_status_pendencia">Status pendência</label>
                            <div class="input-group">
                                <textarea name="status_pendencia" rows="4" id="id_status_pendencia"
                                    value="{{tarefa.status_pendencia}}">{{tarefa.status_pendencia}}</textarea>
                                <button type="button" id="copiar">
                                    Copiar
                                </button>
                            </div>
                        </div>
                        <div class="col" id="historico">
                            <label for="id_historico">Histórico</label>
                            <div class="input-group">
                                <textarea name="historico" rows="4" id="id_historico"
                                    value="{{tarefa.historico}}">{{tarefa.historico}}</textarea>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-3" id="impedimento">
                            <label for="id_pendente_por">Impedimento:</label>
                            <div class="input-group bs-select">
                                {{ form.pendente_por }}
                            </div>
                        </div>
                        <div class="col-3" id="processo">
                            <label for="id_processo_relacionado">*Processo relacionado:</label>
                            <div class="input-group bs-select">
                                {{ form.processo_relacionado }}
                            </div>
                        </div>
                        <div class="col-3" id="r5w2h">
                            <label for="id_5w2h">5W2H:</label>
                            <div class="input-group bs-select">
                                {{ form.r5w2hT }}
                            </div>
                        </div>
                        <div class="col-3" id="retrospectiva">
                            <label for="id_retrospectiva">Retrospectiva:</label>
                            <div class="input-group bs-select">
                            {{ form.retrospec }}
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-4" id="medicao-terceiros">
                            <label for="id_medicao-terceiros">Medição Terceiros:</label>
                            <div class="input-group bs-select">
                                {{ form.id_medicao }}
                            </div>
                        </div>
                    </div>

                    <div id="executoresTarefa">
                        <div class="row">
                            <div class="col" id="executor">
                                <label for="add-executor">*Executores: </label>
                                <button type="button" id="add-executor">
                                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>

                        <div class="row" id="Executores">
                            <div class="col executor" id="executor1">
                                <div class="input group bs-select executor">
                                    {{ executores_form.executor1 }}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento1 }}
                                </div>
                            </div>
                        </div>

                        <div class="row" id="Executores2-6">
                            <div class="col executor" id="executor2" hidden="hidden">
                                <button type="button" id="remove-executor2">
                                    <i class="fa fa-trash" aria-hidden="true" id="remove-executor2" for="executor2"></i>
                                </button>
                                <div class="input-group bs-select executor">
                                    {{executores_form.executor2}}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento2 }}
                                </div>
                            </div>
                            <div class="col executor" id="executor3" hidden="hidden">
                                <button type="button" id="remove-executor3">
                                    <i class="fa fa-trash" aria-hidden="true" id="remove-executor3" for="executor3"></i>
                                </button>
                                <div class="input-group bs-select executor">
                                    {{executores_form.executor3}}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento3 }}
                                </div>
                            </div>
                            <div class="col executor" id="executor4" hidden="hidden">
                                <button type="button" id="remove-executor4">
                                    <i class="fa fa-trash" aria-hidden="true" id="remove-executor4" for="executor4"></i>
                                </button>
                                <div class="input-group bs-select executor">
                                    {{executores_form.executor4}}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento4 }}
                                </div>
                            </div>
                            <div class="col executor" id="executor5" hidden="hidden">
                                <button type="button" id="remove-executor5">
                                    <i class="fa fa-trash" aria-hidden="true" id="remove-executor5" for="executor5"></i>
                                </button>
                                <div class="input-group bs-select executor">
                                    {{executores_form.executor5}}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento5 }}
                                </div>
                            </div>
                            <div class="col executor" id="executor6" hidden="hidden">
                                <button type="button" id="remove-executor6">
                                    <i class="fa fa-trash" aria-hidden="true" id="remove-executor6" for="executor6"></i>
                                </button>
                                <div class="input-group bs-select executor">
                                    {{executores_form.executor6}}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento6 }}
                                </div>
                            </div>
                        </div>

                        <div class="row" id="Executores7-10">
                            <div class="col executor" id="executor7" hidden="hidden">
                                <button type="button" id="remove-executor7">
                                    <i class="fa fa-trash" aria-hidden="true" id="remove-executor7" for="executor7"></i>
                                </button>
                                <div class="input-group bs-select executor">
                                    {{executores_form.executor7}}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento7 }}
                                </div>
                            </div>

                            <div class="col executor" id="executor8" hidden="hidden">
                                <button type="button" id="remove-executor8">
                                    <i class="fa fa-trash" aria-hidden="true" id="remove-executor8" for="executor8"></i>
                                </button>
                                <div class="input-group bs-select executor">
                                    {{executores_form.executor8}}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento8 }}
                                </div>
                            </div>
                            <div class="col executor" id="executor9" hidden="hidden">
                                <button type="button" id="remove-executor9">
                                    <i class="fa fa-trash" aria-hidden="true" id="remove-executor9" for="executor9"></i>
                                </button>
                                <div class="input-group bs-select executor">
                                    {{executores_form.executor9}}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento9 }}
                                </div>
                            </div>
                            <div class="col executor" id="executor10" hidden="hidden">
                                <button type="button" id="remove-executor10">
                                    <i class="fa fa-trash" aria-hidden="true" id="remove-executor10"
                                        for="executor10"></i>
                                </button>
                                <div class="input-group bs-select executor">
                                    {{executores_form.executor10}}
                                </div>
                                <div class="input-group" id="porcentagem-executor">
                                    {{ executores_form.porcento10 }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="display: none;">
                        {{form.id_locacao}}
                        {{form.id_juridico}}
                    </div>
                </div>

                <!-- Anexo -->
                <div class="fAnexo" id="fAnexo">
                    <div class="row">
                        <h1 class="col">Anexos</h1>
                    </div>
                    <div class="row">
                        <p class="col">Em desenvolvimento</p>
                    </div>
                </div>

                <!-- Filhos -->
                <div class="fFilho" id="fFilho">
                    <div class="titulos">
                        <span class="titulo-child afazer">A fazer</span>
                        <span class="titulo-child fazendo">Fazendo</span>
                        <span class="titulo-child feito">Feito</span>
                    </div>
                    <div class="quadro" id="quadro">
                        <!--Quadro de tarefas A fazer-->
                        <div class="quadro-child quadro1 1">
                          {% for filho in filhosAFazer %}
                                <div id="{{ filho.id_tarefa }}" class="card1 tarefa mt-3 mb-3 ml-2 mr-2 w-95 p">
                                    <div class="card-body">
                                        <div class="row justify-content-between">
                                        <div class="col-xs align-self-start idTarefa p">
                                            <span class="id" title="ID" aria-label="100%">{{ filho.id_tarefa }}</span>
                                        </div>
                                        <div class="col-xs prioridadeTarefa p">
                                            <span id="prioridade{{ filho.id_tarefa }}" title="Prioridade" aria-label="100%">{{ filho.prioridade }}</span>
                                        </div>
                                        <div id="statusPrazo{{ filho.id_tarefa }}" class="col-xs situacao_data p">
                                            <span title="" aria-label="100%"></span>
                                        </div>
                                        <div id="status{{ filho.id_tarefa }}" class="col-xs" style="display: none;">{{filho.stat}}</div>
                                        <div id="prazo{{ filho.id_tarefa }}" class="col-xs" style="display: none;">{{ filho.prazo }}</div>
                                        <div class="col-xs ccTarefa p">
                                            <span title="Centro de Custo" aria-label="100%">{{ filho.centro_custo }}</span>
                                        </div>
                                        <span id="is_locacao{{ filho.id_tarefa }}" class="col-xs" style="display: none;">{{filho.id_status}}</span>
                                        <span title="Editar">
                                            <div class="bt_editar col-xs align-self-end p">
                                                <a href="#" class="card-link">
                                                <img src="{% static 'Kanban/img/editar.png' %}" class="editar" onclick="editarTarefa({{filho.id_tarefa}})"/>
                                                </a>
                                            </div>
                                        </span>
                                        </div>
                                        <span title="Descrição" class="descricaoTarefa border">{{ filho.descri }}</span>
                                    </div>
                                    <div class="card-footer bg-transparent">
                                        <div class="d-flex justify-content-around text-left">
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Status:</div>
                                                <span id="stat{{filho.id_tarefa}}" title="{{filho.stat}}" style="display: none;"></span>
                                                <select name="stat{{filho.id_tarefa}}" class="form-control form-control-sm">
                                                    <option value="A fazer">A fazer</option>
                                                    <option value="Fazendo">Fazendo</option>
                                                    <option value="Feito">Feito</option>
                                                    <option value="Cancelado">Cancelado</option>
                                                  
                                                  </select>
                                            </div>
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Porcentagem:</div>
                                                <span id="porcentagem{{filho.id_tarefa}}" title="{{filho.porcentagem}}" style="display: none;"></span>
                                                <input type="number" name="porcentagem{{filho.id_tarefa}}" value="{{filho.porcentagem}}" class="form-control form-control-sm" >
                                            </div>
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Data Inicial:</div>
                                                <span id="data_ini{{filho.id_tarefa}}" title="{{filho.data_ini}}" style="display: none;"></span>
                                                <div class="input-group date">
                                                    <input type="text" name="data_ini{{filho.id_tarefa}}" value="{{filho.data_ini}}" class="input--style-4 js-datepicker form-control form-control-sm" autocomplete="off">
                                                </div>
                                            </div>
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Data fim real:</div>
                                                <span id="data_fim{{filho.id_tarefa}}" title="{{filho.data_fim}}" style="display: none;"></span>
                                                <div class="input-group date">
                                                    <input type="text" name="data_fim{{filho.id_tarefa}}" value="{{filho.data_fim}}" class="input--style-4 js-datepicker form-control form-control-sm" autocomplete="off">
                                                </div>
                                            </div>
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Tamanho:</div>
                                                <span id="tamanho{{filho.id_tarefa}}" title="{{filho.tamanho}}" style="display: none;"></span>
                                                <select name="tamanho{{filho.id_tarefa}}" class="form-control form-control-sm">
                                                    <option value="">---------</option>
                                                    <option value="1">Baby</option>
                                                    <option value="2">PP</option>
                                                    <option value="3">P</option>
                                                    <option value="4">M</option>
                                                    <option value="5">G</option>
                                                    <option value="6">GG</option>
                                                    <option value="7">EG</option>
                                                    <option value="8">Gigante</option>
                                                    <option value="9">Gigante 1</option>
                                                    <option value="10">Gigante 2</option>
                                                    <option value="11">Gigante 3</option>
                                                    <option value="12">Gigante 4</option>
                                                    <option value="13">Gigante 5</option>
                                                  </select>
                                            </div>
                                        </div>
                                        <div class="row justify-content-between">
                                            <div class="col-xs" style="width: 175px;">
                                                <div class="row">
                                                    <span style="display:none;" id="executores{{filho.id_tarefa}}">{{filho.Executores}}</span>
                                                    <div class="row" id="imagensExecutores{{filho.id_tarefa}}"></div>
                                                </div>
                                            </div>
                                            <div class="row" style="margin-left: -20px;">
                                                <span id="autoridade{{ filho.id_tarefa }}" class="col-xs p-icone autoridade" style="margin-top: 6px; position: relative; right: 0" title="{{filho.autoridade}}"><img id="imgAutoridade{{filho.id_tarefa}}" class="rounded-circle" alt="Cinque Terre" style="width: 100%; height: 100%"></span>
                                                <span id="responsavel{{ filho.id_tarefa }}" class="col-xs p-icone responsavel mr-1" style="margin-top: 6px; position: relative; right: 0;" title="{{filho.responsavel}}"><img id="imgResponsavel{{filho.id_tarefa}}" class="rounded-circle" alt="Cinque Terre" style="width: 100%; height: 100%"></span>
                                            </div>
                                            <span class="col-xs align-self-center dptoTarefa" title="Departamento">{{ filho.departamento }}</span>
                                            <span id="impedimento{{ filho.id_tarefa }}" class="col-xs i-icone pendente" style="position: relative;" title="{{ filho.pendente_por }}"><img id="imgImpedimento{{filho.id_tarefa}}" class="rounded-circle" alt="Cinque Terre" style="width: 100%; height: 100%"></span>
                                            <span 
                                                class="bt_expandir col-xs align-self-end" 
                                                title="Expandir"
                                                id="expandir{{filho.id_tarefa}}"
                                            ><a><img src="{% static 'Kanban/img/expandir.png' %}" class="expandir"/></a></span>
                                        </div>
                                        <div id="{{ filho.id_tarefa }}_mostrar" class="container mostrarTarefa mt-2">
                                            <div class="blocoPendencia text-left" style="margin: 2vh 6px" id="{{ filho.id_tarefa }}_mostrar">
                                                <div>Status Pendência:</div>
                                                <div class="input-group" style="gap: 0.5rem">
                                                    <textarea 
                                                        id="status_pendencia{{filho.id_tarefa}}" 
                                                        name="status_pendencia{{filho.id_tarefa}}" 
                                                        class="form-control form-control-sm" 
                                                        rows="4" 
                                                        value="{{filho.status_pendencia}}"
                                                    >{{filho.status_pendencia}}</textarea>
                                                    <button type="button" id="copiar{{filho.id_tarefa}}">
                                                        Copiar
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="blocoHistorico text-left" style="margin: 2vh 6px" id="{{ filho.id_tarefa }}_mostrarHistorico">
                                                <div>Histórico:</div>
                                                <div class="input-group" style="gap: 0.5rem">
                                                    <textarea 
                                                        id="historico{{filho.id_tarefa}}"
                                                        name="historico{{filho.id_tarefa}}" 
                                                        class="form-control form-control-sm" 
                                                        rows="4" 
                                                        value="{{filho.historico}}"
                                                    >{{filho.historico}}</textarea>
                                                </div>
                                            </div>
                                            <div class="row" style="display: none;">
                                                <span class="col-xs tamanhoTarefa align-self-center" title="Tamanho - Pontos" id="peso{{filho.id_tarefa}}">{{ filho.tamanho }}</span>
                                                <div class="row justify-content-center mt-2">
                                                    <span class="col-xs data_inicio border mr-1" id="dataInicial{{ filho.id_tarefa }}" title="Data Início">{{ filho.data_ini }}</span>
                                                    <span class="col-xs data_limite border ml-1" id="dataFinal{{ filho.id_tarefa }}" title="Data Fim">{{ filho.data_fim }}</span>
                                                </div>
                                                <div class="row justify-content-between mt-2">
                                                    <span class="col-xs mr-1 align-self-center" title="Etapa">{{ filho.etapa }}</span>
                                                    <span class="col-xs mr-1 align-self-center" title="SubEtapa">{{ filho.subetapa }}</span>
                                                </div>
                                                <div class="row justify-content-between mt-2">
                                                    <span class="col-xs processoTarefa align-self-center" title="Processo">{{ filho.processo_relacionado }}</span>
                                                    <span id="anexo{{filho.id_tarefa}}" class="col-xs align-self-end" title="Anexo"><a><img src="{% static 'Kanban/img/clipe.png' %}" class="anexo_ver"/></a></span>
                                                    <div id="anexo1{{filho.id_tarefa}}" style="display: none;">{{filho.anexo1}}</div>
                                                    <span id="retrospectiva{{filho.id_tarefa}}" class="col-xs align-self-end imgRetrospectiva" title="Retrospectiva"><a><img src="{% static 'Kanban/img/retrospectiva.png' %}" class="anexo_ver" id="imgRetrospectiva"/></a></span>
                                                    <div id="retrospectiva1{{filho.id_tarefa}}" style="display: none;">{{filho.retrospec}}</div>
                                                    <span id="r5w2h{{filho.id_tarefa}}" class="col-xs align-self-end" title="5W2H"><a><img src="{% static 'Kanban/img/5w2h.png' %}" class="anexo_ver" id="img5w2h"/></a></span>
                                                    <div id="r5w2h1{{filho.id_tarefa}}" style="display: none;">{{filho.r5w2hT}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        <!--Quadro de tarefas Fazendo-->
                        <div class="quadro-child quadro1 2">
                          {% for filho in filhosFazendo %}
                                <div id="{{ filho.id_tarefa }}" class="card1 tarefa mt-3 mb-3 ml-2 mr-2 w-95 p">
                                    <div class="card-body">
                                        <div class="row justify-content-between">
                                        <div class="col-xs align-self-start idTarefa p">
                                            <span class="id" title="ID" aria-label="100%">{{ filho.id_tarefa }}</span>
                                        </div>
                                        <div class="col-xs prioridadeTarefa p">
                                            <span id="prioridade{{ filho.id_tarefa }}" title="Prioridade" aria-label="100%">{{ filho.prioridade }}</span>
                                        </div>
                                        <div id="statusPrazo{{ filho.id_tarefa }}" class="col-xs situacao_data p">
                                            <span title="" aria-label="100%"></span>
                                        </div>
                                        <div id="status{{ filho.id_tarefa }}" class="col-xs" style="display: none;">{{filho.stat}}</div>
                                        <div id="prazo{{ filho.id_tarefa }}" class="col-xs" style="display: none;">{{ filho.prazo }}</div>
                                        <div class="col-xs ccTarefa p">
                                            <span title="Centro de Custo" aria-label="100%">{{ filho.centro_custo }}</span>
                                        </div>
                                        <span id="is_locacao{{ filho.id_tarefa }}" class="col-xs" style="display: none;">{{filho.id_status}}</span>
                                        <span title="Editar">
                                            <div class="bt_editar col-xs align-self-end p">
                                                <a href="#" class="card-link">
                                                <img src="{% static 'Kanban/img/editar.png' %}" class="editar" onclick="editarTarefa({{filho.id_tarefa}})"/>
                                                </a>
                                            </div>
                                        </span>
                                        </div>
                                        <span title="Descrição" class="descricaoTarefa border">{{ filho.descri }}</span>
                                    </div>
                                    <div class="card-footer bg-transparent">
                                        <div class="d-flex justify-content-around text-left">
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Status:</div>
                                                <span id="stat{{filho.id_tarefa}}" title="{{filho.stat}}" style="display: none;"></span>
                                                <select name="stat{{filho.id_tarefa}}" class="form-control form-control-sm">
                                                    <option value="A fazer">A fazer</option>
                                                    <option value="Fazendo">Fazendo</option>
                                                    <option value="Feito">Feito</option>
                                                    <option value="Cancelado">Cancelado</option>
                                                  
                                                  </select>
                                            </div>
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Porcentagem:</div>
                                                <span id="porcentagem{{filho.id_tarefa}}" title="{{filho.porcentagem}}" style="display: none;"></span>
                                                <input type="number" name="porcentagem{{filho.id_tarefa}}" value="{{filho.porcentagem}}" class="form-control form-control-sm" >
                                            </div>
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Data Inicial:</div>
                                                <span id="data_ini{{filho.id_tarefa}}" title="{{filho.data_ini}}" style="display: none;"></span>
                                                <div class="input-group date">
                                                    <input type="text" name="data_ini{{filho.id_tarefa}}" value="{{filho.data_ini}}" class="input--style-4 js-datepicker form-control form-control-sm" autocomplete="off">
                                                </div>
                                            </div>
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Data fim real:</div>
                                                <span id="data_fim{{filho.id_tarefa}}" title="{{filho.data_fim}}" style="display: none;"></span>
                                                <div class="input-group date">
                                                    <input type="text" name="data_fim{{filho.id_tarefa}}" value="{{filho.data_fim}}" class="input--style-4 js-datepicker form-control form-control-sm" autocomplete="off">
                                                </div>
                                            </div>
                                            <div class="blocoInfoChild ml-1 mr-1">
                                                <div>Tamanho:</div>
                                                <span id="tamanho{{filho.id_tarefa}}" title="{{filho.tamanho}}" style="display: none;"></span>
                                                <select name="tamanho{{filho.id_tarefa}}" class="form-control form-control-sm">
                                                    <option value="">---------</option>
                                                    <option value="1">Baby</option>
                                                    <option value="2">PP</option>
                                                    <option value="3">P</option>
                                                    <option value="4">M</option>
                                                    <option value="5">G</option>
                                                    <option value="6">GG</option>
                                                    <option value="7">EG</option>
                                                    <option value="8">Gigante</option>
                                                    <option value="9">Gigante 1</option>
                                                    <option value="10">Gigante 2</option>
                                                    <option value="11">Gigante 3</option>
                                                    <option value="12">Gigante 4</option>
                                                    <option value="13">Gigante 5</option>
                                                  </select>
                                            </div>
                                        </div>
                                        <div class="row justify-content-between">
                                            <div class="col-xs" style="width: 175px;">
                                                <div class="row">
                                                    <span style="display:none;" id="executores{{filho.id_tarefa}}">{{filho.Executores}}</span>
                                                    <div class="row" id="imagensExecutores{{filho.id_tarefa}}"></div>
                                                </div>
                                            </div>
                                            <div class="row" style="margin-left: -20px;">
                                                <span id="autoridade{{ filho.id_tarefa }}" class="col-xs p-icone autoridade" style="margin-top: 6px; position: relative; right: 0" title="{{filho.autoridade}}"><img id="imgAutoridade{{filho.id_tarefa}}" class="rounded-circle" alt="Cinque Terre" style="width: 100%; height: 100%"></span>
                                                <span id="responsavel{{ filho.id_tarefa }}" class="col-xs p-icone responsavel mr-1" style="margin-top: 6px; position: relative; right: 0;" title="{{filho.responsavel}}"><img id="imgResponsavel{{filho.id_tarefa}}" class="rounded-circle" alt="Cinque Terre" style="width: 100%; height: 100%"></span>
                                            </div>
                                            <span class="col-xs align-self-center dptoTarefa" title="Departamento">{{ filho.departamento }}</span>
                                            <span id="impedimento{{ filho.id_tarefa }}" class="col-xs i-icone pendente" style="position: relative;" title="{{ filho.pendente_por }}"><img id="imgImpedimento{{filho.id_tarefa}}" class="rounded-circle" alt="Cinque Terre" style="width: 100%; height: 100%"></span>
                                            <span 
                                                class="bt_expandir col-xs align-self-end" 
                                                title="Expandir"
                                                id="expandir{{filho.id_tarefa}}"
                                            ><a><img src="{% static 'Kanban/img/expandir.png' %}" class="expandir"/></a></span>
                                        </div>
                                        <div id="{{ filho.id_tarefa }}_mostrar" class="container mostrarTarefa mt-2">
                                            <div class="blocoPendencia text-left" style="margin: 2vh 6px" id="{{ filho.id_tarefa }}_mostrar">
                                                <div>Status Pendência:</div>
                                                <div class="input-group" style="gap: 0.5rem">
                                                    <textarea 
                                                        id="status_pendencia{{filho.id_tarefa}}" 
                                                        name="status_pendencia{{filho.id_tarefa}}" 
                                                        class="form-control form-control-sm" 
                                                        rows="4" 
                                                        value="{{filho.status_pendencia}}"
                                                    >{{filho.status_pendencia}}</textarea>
                                                    <button type="button" id="copiar{{filho.id_tarefa}}">
                                                        Copiar
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="blocoHistorico text-left" style="margin: 2vh 6px" id="{{ filho.id_tarefa }}_mostrarHistorico">
                                                <div>Histórico:</div>
                                                <div class="input-group" style="gap: 0.5rem">
                                                    <textarea 
                                                        id="historico{{filho.id_tarefa}}"
                                                        name="historico{{filho.id_tarefa}}" 
                                                        class="form-control form-control-sm" 
                                                        rows="4" 
                                                        value="{{filho.historico}}"
                                                    >{{filho.historico}}</textarea>
                                                </div>
                                            </div>
                                            <div class="row" style="display: none;">
                                                <span class="col-xs tamanhoTarefa align-self-center" title="Tamanho - Pontos" id="peso{{filho.id_tarefa}}">{{ filho.tamanho }}</span>
                                                <div class="row justify-content-center mt-2">
                                                    <span class="col-xs data_inicio border mr-1" id="dataInicial{{ filho.id_tarefa }}" title="Data Início">{{ filho.data_ini }}</span>
                                                    <span class="col-xs data_limite border ml-1" id="dataFinal{{ filho.id_tarefa }}" title="Data Fim">{{ filho.data_fim }}</span>
                                                </div>
                                                <div class="row justify-content-between mt-2">
                                                    <span class="col-xs mr-1 align-self-center" title="Etapa">{{ filho.etapa }}</span>
                                                    <span class="col-xs mr-1 align-self-center" title="SubEtapa">{{ filho.subetapa }}</span>
                                                </div>
                                                <div class="row justify-content-between mt-2">
                                                    <span class="col-xs processoTarefa align-self-center" title="Processo">{{ filho.processo_relacionado }}</span>
                                                    <span id="anexo{{filho.id_tarefa}}" class="col-xs align-self-end" title="Anexo"><a><img src="{% static 'Kanban/img/clipe.png' %}" class="anexo_ver"/></a></span>
                                                    <div id="anexo1{{filho.id_tarefa}}" style="display: none;">{{filho.anexo1}}</div>
                                                    <span id="retrospectiva{{filho.id_tarefa}}" class="col-xs align-self-end imgRetrospectiva" title="Retrospectiva"><a><img src="{% static 'Kanban/img/retrospectiva.png' %}" class="anexo_ver" id="imgRetrospectiva"/></a></span>
                                                    <div id="retrospectiva1{{filho.id_tarefa}}" style="display: none;">{{filho.retrospec}}</div>
                                                    <span id="r5w2h{{filho.id_tarefa}}" class="col-xs align-self-end" title="5W2H"><a><img src="{% static 'Kanban/img/5w2h.png' %}" class="anexo_ver" id="img5w2h"/></a></span>
                                                    <div id="r5w2h1{{filho.id_tarefa}}" style="display: none;">{{filho.r5w2hT}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
              
                        <!--Quadro de tarefas Feitas-->
                        <div class="quadro-child quadro1 3">
                            {% for filho in filhosFeito %}
                                <div id="{{ filho.id_tarefa }}" class="card1 tarefa mt-3 mb-3 ml-2 mr-1 w-95 p">
                                <div class="card-body">
                                <div class="row justify-content-between">
                                    <div class="col-xs align-self-start idTarefa p">
                                        <span title="ID" aria-label="100%">{{ filho.id_tarefa }}</span>
                                    </div>
                                    <div class="col-xs prioridadeTarefa p">
                                        <span id="prioridade{{ filho.id_tarefa }}" title="Prioridade" aria-label="100%">{{ filho.prioridade }}</span>
                                    </div>
                                    <div id="statusPrazo{{ filho.id_tarefa }}" class="col-xs situacao_data p">
                                        <span title="" aria-label="100%"></span>
                                    </div>
                                    <div id="status{{ filho.id_tarefa }}" class="col-xs" style="display: none;">{{filho.stat}}</div>
                                    <div id="prazo{{ filho.id_tarefa }}" class="col-xs" style="display: none;">{{ filho.prazo }}</div>
                                    <div class="col-xs ccTarefa p">
                                        <span title="Centro de Custo" aria-label="100%">{{ filho.centro_custo }}</span>
                                    </div>
                                    <span id="is_locacao{{ filho.id_tarefa }}" class="col-xs" style="display: none;">{{filho.id_status}}</span>
                                    <span title="Editar">
                                        <div class="bt_editar col-xs align-self-end p">
                                        <a href="#" class="card-link">
                                            <img src="{% static 'Kanban/img/editar.png' %}" class="editar" onclick="editarTarefa({{filho.id_tarefa}})"/>
                                        </a>
                                        </div>
                                    </span>
                                </div>
                                <span title="Descrição" class="descricaoTarefa border">{{ filho.descri }}</span>
                                </div>
                                <div class="card-footer bg-transparent">
                                <div class="row justify-content-between">
                                    <div class="col-xs" style="width: 175px;">
                                        <div class="row">
                                            <span style="display:none;" id="executores{{filho.id_tarefa}}">{{filho.Executores}}</span>
                                            <div class="row" id="imagensExecutores{{filho.id_tarefa}}"></div>
                                        </div>
                                    </div>
                                    <div class="row" style="margin-left: -20px;">
                                        <span id="autoridade{{ filho.id_tarefa }}" class="col-xs p-icone autoridade" style="margin-top: 6px; position: relative; right: 0" title="{{filho.autoridade}}"><img id="imgAutoridade{{filho.id_tarefa}}" class="rounded-circle" alt="Cinque Terre" style="width: 100%; height: 100%"></span>
                                        <span id="responsavel{{ filho.id_tarefa }}" class="col-xs p-icone responsavel mr-1" style="margin-top: 6px; position: relative; right: 0;" title="{{filho.responsavel}}"><img id="imgResponsavel{{filho.id_tarefa}}" class="rounded-circle" alt="Cinque Terre" style="width: 100%; height: 100%"></span>
                                    </div>
                                    <span class="col-xs align-self-center dptoTarefa" title="Departamento">{{ filho.departamento }}</span>
                                    <span id="impedimento{{ filho.id_tarefa }}" class="col-xs i-icone pendente" title="{{ filho.pendente_por }}"><img id="imgImpedimento{{filho.id_tarefa}}" class="rounded-circle" alt="Cinque Terre" style="width: 100%; height: 100%"></span>
                                    <span 
                                        class="bt_expandir col-xs align-self-end" 
                                        title="Expandir"
                                        id="expandir{{filho.id_tarefa}}"
                                    ><a><img src="{% static 'Kanban/img/expandir.png' %}" class="expandir"/></a></span>
                                </div>
                                <div id="{{ filho.id_tarefa }}_mostrar" class="container mostrarTarefa mt-2">
                                    <span class="statusTarefa border" title="Pendente">{{ filho.status_pendencia }}</span>
                                    <div class="row">
                                    <span class="col-xs tamanhoTarefa align-self-center" title="Tamanho - Pontos" id="peso{{filho.id_tarefa}}">{{ filho.tamanho }}</span>
                                    </div>
                                    <div class="row justify-content-center mt-2">
                                    <span class="col-xs data_inicio border mr-1" id="dataInicial{{ filho.id_tarefa }}" title="Data Início">{{ filho.data_ini }}</span>
                                    <span class="col-xs data_limite border ml-1" id="dataFinal{{ filho.id_tarefa }}" title="Data Fim">{{ filho.data_fim }}</span>
                                    </div>
                                    {% if filho.etapa != None %}
                                        <div class="row justify-content-between mt-2">
                                            <span class="col-xs mr-1 align-self-center" title="Etapa">{{ filho.etapa }}</span>
                                            <span class="col-xs mr-1 align-self-center" title="SubEtapa">{{ filho.subetapa }}</span>
                                        </div>
                                    {% endif %}
                                    <div class="row justify-content-between mt-2">
                                    <span class="col-xs processoTarefa align-self-center" title="Processo">{{ filho.processo_relacionado }}</span>
                                    <span id="anexo{{filho.id_tarefa}}" class="col-xs align-self-end" title="Anexo"><a><img src="{% static 'Kanban/img/clipe.png' %}" class="anexo_ver"/></a></span>
                                    <div id="anexo1{{filho.id_tarefa}}" style="display: none;">{{filho.anexo1}}</div>
                                    <div id="anexo1{{filho.id_tarefa}}" style="display: none;">{{filho.anexo1}}</div>
                                    <span id="retrospectiva{{filho.id_tarefa}}" class="col-xs align-self-end imgRetrospectiva" title="Retrospectiva"><a><img src="{% static 'Kanban/img/retrospectiva.png' %}" class="anexo_ver" id="imgRetrospectiva"/></a></span>
                                    <div id="retrospectiva1{{filho.id_tarefa}}" style="display: none;">{{filho.retrospec}}</div>
                                    <span id="r5w2h{{filho.id_tarefa}}" class="col-xs align-self-end" title="5W2H"><a><img src="{% static 'Kanban/img/5w2h.png' %}" class="anexo_ver" id="img5w2h"/></a></span>
                                    <div id="r5w2h1{{filho.id_tarefa}}" style="display: none;">{{filho.r5w2hT}}</div>
                                    </div>
                                </div>
                                </div>
                                </div>
                            {% endfor %}
                        </div>
                        <div style="visibility: hidden; margin-left: -10px;">-</div>
                    </div>
                </div>

                <!-- Retrospectiva -->
                <div class="fRetrospectiva" id="fRetrospectiva">
                    <div id="rCabecalho">
                        <div class="row">
                            <span class="col-2" id="wId"
                                title="Atualizado por {{retrospectiva.id_update.nome}} em {{retrospectiva.last_update}}">
                                <label for="id_rTarefa">ID Tarefa:</label>
                                <input name="idTarefa" type="text" value="{{tarefa.id_tarefa}}" id="id_rTarefa"
                                    readonly="true" />
                            </span>
                            <div class="col-7">
                                <label for="id_descri">Descrição:</label>
                                <div class="input-group">
                                    <textarea name="rDescricao" rows="1" required="" id="id_descri"
                                        style="resize: none;" readonly>{{tarefa.descri}}</textarea>
                                </div>
                            </div>
                            <div id="imagensExecutores"></div>
                            <div id="imagensAR">
                                <span id="rResponsavel" class="col-xs p-icone responsavel mr-1"><img id="imgResponsavel"
                                        class="rounded-circle" style="width: 100%; height: 100%"></span>
                                <span id="rAutoridade" class="col-xs p-icone autoridade"><img id="imgAutoridade"
                                        class="rounded-circle" style="width: 100%; height: 100%"></span>
                            </div>
                        </div>
                    </div>
                    <div id="rConteudo">
                        <span class="row" id="rDescri"
                            title="A Retrospectiva do Sprint corresponde à “verificação” do ciclo PDCA de Deming. A chave é chegar à etapa “aja”, àquele kaizen, que vai realmente mudar o processo e torná-lo melhor da próxima vez. Não é suficiente compartilhar como você se sente; você precisa ser capaz de agir.">
                            <div class="col">
                                <label for="id_classificacao">*Descreva o aprimoramento do processo: <span
                                        id="aprimorar"></span></label>
                                <div class="input-group">
                                    <textarea name="classificacao" rows="4" id="id_classificacao" value=""></textarea>
                                </div>
                            </div>
                        </span>
                        <div class="row" id="rDescri">
                            <div class="col-2">
                                <button type="button" id="rCopiar">Copiar</button>
                            </div>
                            <div class="col">
                                <p id="melhoria">Melhoria sugerida por: {{retrospectiva.id_update.nome}} em
                                    {{retrospectiva.last_update}}.</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="status">
                                <label for="id_stats">*Status: </label>
                                <div class="input-group bs-select">
                                    {{ form.rStat }}
                                </div>
                            </div>
                            <div class="col" id="responsavelRetrospectiva">
                                <label for="id_responsavel">*Responsável:</label>
                                <div class="input-group bs-select">
                                    {{ form.id_responsavel }}
                                </div>
                            </div>
                            <div class="col" id="retrospectiva">
                                <label for="id_retrospectiva">Retrospectiva:</label>
                                <div class="input-group bs-select">
                                    {{ form.retrospectiva }}
                                </div>
                            </div>
                        </div>
                        <div class="row" id="finalizarRetrospectiva" style="display: none;">
                            <div class="col">
                                <label for="id_finalizar">Finalizar:</label>
                                <div class="input-group bs-select">
                                    {{ form.finalizado }}
                                </div>
                            </div>
                        </div>
                        <span class="row" id="rHistorico"
                            title="Para ser eficaz, essa reunião requer certa dose de maturidade emocional e atmosfera de confiança. O importante é lembrar-se sempre de que você não está procurando culpados; está olhando para o processo. Por que aquilo aconteceu assim? Por que vocênão percebeu aquilo? O que poderia ter acontecido para sermos mais ágeis? É essencial que as pessoas na equipe assumam a responsabilidade pelo processo e seus respectivos resultados, e que busquem soluções como uma equipe. Ao mesmo tempo, elas têm de ter coragem de levantar as questões que realmente as incomodam, de forma que a solução seja orientada, em vez de acusadora. E o restante da equipe precisa ter maturidade para ouvir o feedback, absorvê-lo e procurar uma solução, em vez de assumir uma postura defensiva.">
                            <div class="col">
                                <label for="id_rHistorico">Histórico:</label>
                                <div class="input-group">
                                    <textarea name="rHistorico" rows="4" id="id_rHistorico" value=""></textarea>
                                </div>
                            </div>
                        </span>
                    </div>
                </div>

                <!-- 5W2H -->
                <div class="f5w2h" id="f5w2h">
                    <div id="rCabecalho">
                        <div class="row">
                            <div class="col-2" id="rId">
                                <label for="id_wTarefa">ID Tarefa:</label>
                                <input name="idTarefa" type="text" value="{{tarefa.id_tarefa}}" id="id_wTarefa"
                                    readonly="true" />
                            </div>

                            <div class="col-10" id="rAtualizado">
                                <p id="rAtualizacao">Atualizado por <span id="rNome">{{r5w2h.id_update.nome}}</span> em
                                    <span id="rDataHora">{{r5w2h.last_update}}</span></p>
                            </div>
                        </div>
                    </div>
                    <div id="rConteudo">
                        <div class="row" id="rWhat">
                            <div class="col">
                                <span title="O que?"><label for="id_stats">*What: </label></span>
                                <div class="input-group">
                                    <textarea name="rWhat" rows="2" id="id_rWhat" value=""></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="rWhy">
                                <span title="Por que?"><label for="id_stats">*Why: </label></span>
                                <div class="input-group bs-select">
                                    <textarea name="rWhy" rows="2" id="id_rWhy" value=""></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="rWhere">
                                <span title="Onde?"><label for="id_stats">*Where: </label></span>
                                <div class="input-group bs-select">
                                    <textarea name="rWhere" rows="1" id="id_rWhere" value=""></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="rWhen">
                                <span title="Quando?"><label for="id_stats">*When: </label></span>
                                <div class="input-group bs-select">
                                    <textarea name="rWhen" rows="1" id="id_rWhen" value=""></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="rWho">
                                <span title="Por quem?"><label for="id_stats">*Who: </label></span>
                                <div class="input-group bs-select">
                                    <textarea name="rWho" rows="2" id="id_rWho" value=""></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="rHow">
                                <span title="Como?"><label for="id_stats">*How: </label></span>
                                <div class="input-group bs-select">
                                    <textarea name="rHow" rows="4" id="id_rHow" value=""></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="rHowMuch">
                                <span title="Quanto? R$"><label for="id_stats">*How Much: </label></span>
                                <div class="input-group bs-select">
                                    <textarea name="rHowMuch" rows="2" id="id_rHowMuch" value=""></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SAT  -->
                <div class="sat" id="sat">
                    <div class="row">
                        <div class="col" id="empreendimento">
                            <label for="id_empreendimento">Empreendimento:</label>
                            <div class="input-group bs-select">
                                {{ solicitacao_form.empreendimento }}
                            </div>
                        </div>
                        <div class="col" id="bloco">
                            <label for="id_bloco">Bloco:</label>
                            <div class="input-group bs-select">
                                {{ solicitacao_form.bloco }}
                            </div>
                        </div>
                        <div class="col" id="unidade">
                            <label for="id_unidade">Unidade:</label>
                            <div class="input-group bs-select">
                                {{ solicitacao_form.unidade }}
                            </div>
                        </div>
                        <div class="col" id="proprietario_nome">
                            <label for="id_proprietario_nome">Proprietário:</label>
                            <div class="input-group bs-select">
                                {{ solicitacao_form.proprietario_nome }}
                            </div>
                        </div>
                        <div class="card-header" id="headingOne">
                            <button id="expandir" type="button" class="btn btn-info" data-toggle="collapse"
                                data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                <i class="fa fa-arrows-alt"></i>
                                <span id="botao-filtro">Expandir</span>
                            </button>
                        </div>
                    </div>


                    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-3" id="prop">
                                    <label>Solicitante/Proprietario:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.proprietario_nome1 }}
                                    </div>
                                </div>
                                <div class="col" id="cpf_proprietario">
                                    <label>CPF:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.proprietario_cpf }}
                                    </div>
                                </div>
                                <div class="col" id="rg_proprietario">
                                    <label>RG:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.proprietario_rg }}
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="email_proprietario">
                                <div class="col" id="email_proprietario">
                                    <label>E-MAIL:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.proprietario_email }}
                                    </div>
                                </div>
                                <div class="col" id="telefone1_solicitante">
                                    <label>Numero p/ Contato:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.telefone1 }}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col" id="telefone2_solicitante">
                                    <label>Pessoa p/ Contato:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.solicitante_nome }}
                                    </div>
                                </div>
                                <div class="col" id="cpf_solicitante">
                                    <label>CPF:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.solicitante_cpf }}
                                    </div>
                                </div>
                                <div class="col" id="rg_solicitante">
                                    <label>RG:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.solicitante_rg }}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col" id="email_solicitante">
                                    <label>E-MAIL:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.solicitante_email }}
                                    </div>
                                </div>
                                <div class="col" id="telefone2_solicitante">
                                    <label>Numero p/ Contato:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.telefone2 }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="row" id="cadastro">
                        <div class="cadastro">
                            <div class="row">
                                <div class="col">
                                    <label for="id_id_tarefa">Id tarefa: {{tarefa.id_tarefa}}</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3" id="status_processo">
                                    <label for="id_status_processo">Status processo:</label>
                                    <div class="input-group bs-select">
                                        <span id="statusprocessoTarefa" style="display: none;">{{solicitacao.status_processo}}</span>
                                        <select type="text" name="status_processo" id="id_status_processo"></select>
                                    </div>
                                </div>
                                <div class="col-2" id="porcentagem_sat">
                                    <label for="id_porcentagem_sat">Porcentagem:</label>
                                    <div class="input-group">
                                        {{ solicitacao_form.porcentagem_sat }}
                                    </div>
                                </div>
                                <div class="col-3" id="tipo_solicitacao">
                                    <label for="id_tipo_solicitacao">Tipo solicitacao:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.tipo_solicitacao }}
                                    </div>
                                </div>
                                <div class="col-3" id="satisfacao_avaliacao">
                                    <label for="id_satisfacao_avaliacao">Satisfação do cliente:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.satisfacao_avaliacao }}
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="descri">
                                <div class="col" id="status_solicitacao">
                                    <label for="id_status_solicitacao">Status solicitaçõo:</label>
                                    <div class="input-group">
                                        <textarea name="sDescri" rows="4"
                                            id="id_sDescri">{{solicitacao.status_solicitacao}}</textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3" id="data_abertura">
                                    <label for="id_data_abertura">Data abertura:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.data_abertura }}
                                    </div>
                                </div>
                                <div class="col-3" id="data_atendimento">
                                    <label for="id_data_atendimento">Data atendimento:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.data_atendimento }}
                                    </div>
                                </div>
                                <div class="col-3" id="data_finalizacao_sat">
                                    <label for="id_data_finalizacao_sat">Data finalização:</label>
                                    <div class="input-group bs-select">
                                        {{ solicitacao_form.data_finalizacao_sat }}
                                    </div>
                                </div>
                                <div class="col-3" id="data_entrega">
                                    <label for="id_data_entrega">Data entrega:</label>
                                    <div class="input-group" id="a">
                                        <div class="input-group-icon">
                                            {{ solicitacao_form.data_entrega }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="executoresSat">

                        </div>

                    </div>
                    <div class="problema">
                        <div class="bloco_tTotal" id="tempo_total">
                            <div class="row">
                                <div id="t_total">
                                    <input type="text" id="pesoTotal" hidden>
                                    <label id="label_tempo_total" for="id_tempo_total" data-toggle="modal"
                                        data-target="#modalTamanho">Tempo total:</label>
                                    <div class="input-group">
                                        {{ solicitacao_form.tempo_total }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bloco_problema" id="">
                            <div class="linha_problemas">
                                <div id="problema1"></div>
                                <div id="problema2" style="display: none;"></div>
                                <div id="problema3" style="display: none;"></div>
                                <div id="problema4" style="display: none;"></div>
                                <div id="problema5" style="display: none;"></div>
                                <div id="problema6" style="display: none;"></div>
                                <div id="problema7" style="display: none;"></div>
                                <div id="problema8" style="display: none;"></div>
                                <div id="problema9" style="display: none;"></div>
                                <div id="problema10" style="display: none;"></div>
                                <div id="problema11" style="display: none;"></div>
                                <div id="problema12" style="display: none;"></div>
                                <div id="problema13" style="display: none;"></div>
                                <div id="problema14" style="display: none;"></div>
                                <div id="problema15" style="display: none;"></div>
                                <div id="problema16" style="display: none;"></div>
                                <div id="problema17" style="display: none;"></div>
                                <div id="problema18" style="display: none;"></div>
                                <div id="problema19" style="display: none;"></div>
                                <div id="problema20" style="display: none;"></div>
                            </div>
                            <div style="display: none;" id="qtdProblemas">
                                <input type="text" name="qtdProblemas" value="0">
                            </div>
                        </div>

                        <div id="problemas" style="display: none;">
                        </div>

                        <div class="row" id="botoes">
                            <button type="button" id="add-problema">
                                <i class="fa fa-plus-circle" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Medição Terceiros  -->
                <div class="fMedicaoTerceiros" id="fMedicaoTerceiros">
                    <div class="row">
                        <div class="col-3" id="mes">
                            <label for="id_mes">*Mês de referência:</label>
                            <div class="input-group bs-select">
                                {{medicao_terceiros_form.mes}}
                            </div>
                        </div>
                        <div class="col-3" id="valor_bruto">
                            <label for="id_valor_bruto">*Valor Bruto:</label>
                            <div class="input-group bs-select">
                                {{medicao_terceiros_form.valor_bruto}}
                            </div>
                        </div>
                        <div class="col-3" id="valor_liquido">
                            <label for="id_valor_liquido">*Valor Liquido:</label>
                            <div class="input-group bs-select">
                                {{medicao_terceiros_form.valor_liquido}}
                            </div>
                        </div>
                        <div class="col" id="permuta">
                            <label for="id_permuta">*Permuta:</label>
                            <div class="input-group bs-select">
                                {{medicao_terceiros_form.permuta}}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Locação -->
                <div class="locacao" id="locacao">
                    <div class="d-flex flex-direction-row mt-3">
                        <div class="col" id="blocoCC">
                            <label for="id_centro_custo">*Centro de custo:</label>
                            <div class="input-group bs-select">
                                {{ form.id_centro_custo1 }}
                            </div>
                        </div>
                        <div class="col" id="blocoLocacao">
                            <label for="id_bloco">Bloco:</label>
                            <div class="input-group bs-select">
                                {{ locacao_form.lBloco }}
                            </div>
                        </div>
                        <div class="col" id="unidadeLocacao">
                            <label for="id_unidade">Unidade:</label>
                            <div class="input-group bs-select">
                                {{ locacao_form.lUnidade }}
                            </div>
                        </div>
                        <div class="row" id="statusLocacao" style="display: none;">
                            <label for="id_bloco">Status:</label>
                            <span id="id_status_locacao" style="display: none;">{{tarefa.id_status}}</span>
                            <div class="input-group bs-select">
                                <select type="text" name="id_status" id="id_status_locacao1"></select>
                            </div>
                        </div>
                    </div>
                    {% for executor in executoresFilhos %}
                        <div style="display: none;">
                            <span id="autoridade{{executor.id_tarefa}}">{{executor.autoridade}}</span>
                            <span id="responsavel{{executor.id_tarefa}}">{{executor.responsavel}}</span>
                            <span id="executor1{{executor.id_tarefa}}">{{executor.executor1}}</span>
                            <span id="executor2{{executor.id_tarefa}}">{{executor.executor2}}</span>
                            <span id="executor3{{executor.id_tarefa}}">{{executor.executor3}}</span>
                            <span id="executor4{{executor.id_tarefa}}">{{executor.executor4}}</span>
                            <span id="executor5{{executor.id_tarefa}}">{{executor.executor5}}</span>
                            <span id="executor6{{executor.id_tarefa}}">{{executor.executor6}}</span>
                            <span id="executor7{{executor.id_tarefa}}">{{executor.executor7}}</span>
                            <span id="executor8{{executor.id_tarefa}}">{{executor.executor8}}</span>
                            <span id="executor9{{executor.id_tarefa}}">{{executor.executor9}}</span>
                            <span id="executor10{{executor.id_tarefa}}">{{executor.executor10}}</span>
                        </div>
                    {% endfor %}
                    {% for filho in filhos %}
                        <div class="card1 mt-3 ml-2 mr-2 mb-2" id="card{{filho.id_tarefa}}">
                            <div class="d-flex flex-direction-row align-items-center">
                                <div class="statusFilho" id="status{{filho.id_tarefa}}">{{filho.id_status}}</div>
                                <div id="filhosExecutores{{filho.id_tarefa}}"></div>
                                <div id="filhosAR">
                                    <span id="fAutoridade{{filho.id_tarefa}}" class="col-xs p-icone autoridade"><img id="imgFAutoridade{{filho.id_tarefa}}" class="rounded-circle" style="width: 100%; height: 100%"></span>
                                    <span id="fResponsavel{{filho.id_tarefa}}" class="col-xs p-icone responsavel mr-1"><img id="imgFResponsavel{{filho.id_tarefa}}" class="rounded-circle" style="width: 100%; height: 100%"></span>
                                </div>
                            </div>
                            <div class="blocoInfo">
                                <div class="blocoInfoChild">
                                    <div>ID:</div>
                                    <a class="openTarefa" href="https://myscrum.com.br/tarefas/editar/{{filho.id_tarefa}}" target="_blank"><input type="text" value="{{filho.id_tarefa}}" id="{{filho.id_tarefa}}" name="id{{filho.id_tarefa}}" class="form-control form-control-sm" readonly="“true”" /></a>
                                </div>
                                <div class="blocoInfoChild">
                                    <div>Status:</div>
                                    <span id="stat{{filho.id_tarefa}}" title="{{filho.stat}}" style="display: none;"></span>
                                    <select name="stat{{filho.id_tarefa}}" class="form-control form-control-sm">
                                        <option value="A fazer">A fazer</option>
                                        <option value="Fazendo">Fazendo</option>
                                        <option value="Feito">Feito</option>
                                        <option value="Cancelado">Cancelado</option>
                                      
                                      </select>
                                </div>
                                <div class="blocoInfoChild">
                                    <div>Data Inicial:</div>
                                    <span id="data_ini{{filho.id_tarefa}}" title="{{filho.data_ini}}" style="display: none;"></span>
                                    <div class="input-group date">
                                        <input type="text" name="data_ini{{filho.id_tarefa}}" value="{{filho.data_ini}}" class="input--style-4 js-datepicker form-control form-control-sm" autocomplete="off">
                                    </div>
                                </div>
                                <div class="blocoInfoChild">
                                    <div>Data fim real:</div>
                                    <span id="data_fim{{filho.id_tarefa}}" title="{{filho.data_fim}}" style="display: none;"></span>
                                    <div class="input-group date">
                                        <input type="text" name="data_fim{{filho.id_tarefa}}" value="{{filho.data_fim}}" class="input--style-4 js-datepicker form-control form-control-sm" autocomplete="off">
                                    </div>
                                </div>
                                <div class="blocoInfoChild">
                                    <div>Tamanho:</div>
                                    <span id="tamanho{{filho.id_tarefa}}" title="{{filho.id_tamanho.id_tamanho}}" style="display: none;"></span>
                                    <select name="tamanho{{filho.id_tarefa}}" class="form-control form-control-sm">
                                        <option value="">---------</option>
                                        <option value="1">Baby</option>
                                        <option value="2" selected="">PP</option>
                                        <option value="3">P</option>
                                        <option value="4">M</option>
                                        <option value="5">G</option>
                                        <option value="6">GG</option>
                                        <option value="7">EG</option>
                                        <option value="8">Gigante</option>
                                        <option value="9">Gigante 1</option>
                                        <option value="10">Gigante 2</option>
                                        <option value="11">Gigante 3</option>
                                        <option value="12">Gigante 4</option>
                                        <option value="13">Gigante 5</option>
                                      </select>
                                </div>
                                <span class="bt_expandir col-xs align-self-end" id="expandir{{filho.id_tarefa}}" title="Expandir"><a><img src="{% static 'Kanban/img/expandir.png' %}" class="expandir"/></a></span>
                            </div>
                            <div class="blocoPendencia mostrarLocacao" id="{{ filho.id_tarefa }}_mostrar">
                                <div>Status Pendência:</div>
                                <textarea name="status_pendencia{{filho.id_tarefa}}" class="form-control form-control-sm" rows="4" value="{{filho.status_pendencia}}">{{filho.status_pendencia}}</textarea>
                            </div>
                            <span id="prazo{{filho.id_tarefa}}" style="display: none;">{{filho.prazo}}</span>
                            <span id="porcentagem{{filho.id_tarefa}}" style="display: none;">{{filho.porcentagem}}</span>
                        </div>
                        <script>
                            $("#{{filho.id_tarefa}}").css('cursor', 'pointer');
                            $("#status{{filho.id_tarefa}}").text() == 0 ? $("#status{{filho.id_tarefa}}").text('Tarefa Mãe') : null;
                            $("#status{{filho.id_tarefa}}").text() == 1 ? $("#status{{filho.id_tarefa}}").text('Negociação') : null;
                            $("#status{{filho.id_tarefa}}").text() == 2 ? $("#status{{filho.id_tarefa}}").text('Contrato') : null;
                            $("#status{{filho.id_tarefa}}").text() == 3 ? $("#status{{filho.id_tarefa}}").text('Ligação de Energia') : null;
                            $("#status{{filho.id_tarefa}}").text() == 4 ? $("#status{{filho.id_tarefa}}").text('Comprar') : null;
                            $("#status{{filho.id_tarefa}}").text() == 5 ? $("#status{{filho.id_tarefa}}").text('Pagar') : null;
                            $("#status{{filho.id_tarefa}}").text() == 6 ? $("#status{{filho.id_tarefa}}").text('Instalar') : null;
                            $("#status{{filho.id_tarefa}}").text() == 7 ? $("#status{{filho.id_tarefa}}").text('Limpar') : null;
                            $("#status{{filho.id_tarefa}}").text() == 8 ? $("#status{{filho.id_tarefa}}").text('Vistoria Final') : null;
                            $("#status{{filho.id_tarefa}}").text() == 9 ? $("#status{{filho.id_tarefa}}").text('Entrega de Chaves') : null;
                            $("#status{{filho.id_tarefa}}").text() == 11 ? $("#status{{filho.id_tarefa}}").text('Retorno de Locação') : null;
                            
                            $("[name=stat{{filho.id_tarefa}}]").val($("#stat{{filho.id_tarefa}}").attr('title'));
                            $('[name=data_ini{{filho.id_tarefa}}]').datepicker({todayBtn: "linked", language: "pt-BR", daysOfWeekDisabled: "0,6", daysOfWeekHighlighted: "1,2,3,4,5", autoclose: true, todayHighlight: true});
                            $('[name=data_fim{{filho.id_tarefa}}]').datepicker({todayBtn: "linked", language: "pt-BR", daysOfWeekDisabled: "0,6", daysOfWeekHighlighted: "1,2,3,4,5", autoclose: true, todayHighlight: true });
                            $("[name=tamanho{{filho.id_tarefa}}]").val($("#tamanho{{filho.id_tarefa}}").attr('title'));

                            hoje = new Date();

                            data_inicial = $("[name=data_ini{{filho.id_tarefa}}]").val();
                            data_final = $("[name=data_fim{{filho.id_tarefa}}]").val();

                            formatarInicial = data_inicial.toString().split('/');
                            formatarFinal = data_final.toString().split('/')

                            inicial = new Date(formatarInicial[2] + '-' + formatarInicial[1] + '-' + formatarInicial[0]);
                            final = new Date(formatarFinal[2] + '-' + formatarFinal[1] + '-' + formatarFinal[0]);
                            
                            diaUtil = 0
                            for (i = inicial.getTime(); i <= final.getTime() ; i += 86400000){
                                i += 86400000;
                                diaSemana = new Date(i);
                                if ( (diaSemana.getDay() > 0) && (diaSemana.getDay() < 6) ) {
                                    diaUtil += 1;
                                }
                                i -= 86400000;
                            }

                            prazo = parseInt($("#prazo{{filho.id_tarefa}}").text());
                            realizado = parseInt($("#porcentagem{{filho.id_tarefa}}").text());
                            previsto = (100 * (hoje.getTime() - (inicial.getTime()) + 86400000) / 86400000) / diaUtil;

                            if (inicial.getTime() > hoje.getTime()){
                                previsto = 0;
                            } else if (final.getTime() - hoje.getTime() == 0 || final.getTime() < hoje.getTime()){
                                previsto = 100;
                            }

                            if($("[name=stat{{filho.id_tarefa}}]").val() == "A fazer"){
                                inicial.getTime() >= hoje.getTime() ? $("#card{{filho.id_tarefa}}").addClass('aviso') : $("#card{{filho.id_tarefa}}").addClass('atrasada');
                            } else if ($("[name=stat{{filho.id_tarefa}}]").val() == "Fazendo"){
                                if (realizado > previsto){
                                    $("#card{{filho.id_tarefa}}").addClass('adiantada');
                                } else if((inicial.getTime() + (prazo * 86400000)) >= hoje.getTime()){
                                    $("#card{{filho.id_tarefa}}").addClass('aviso');
                                } else {
                                    $("#card{{filho.id_tarefa}}").addClass('atrasada');
                                }
                            } else{
                                $("#card{{filho.id_tarefa}}").addClass('finalizada');
                            }
                            
                            executor = [], executores = 0;
                            $("#executor1{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor1{{filho.id_tarefa}}").text()) : null;
                            $("#executor2{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor2{{filho.id_tarefa}}").text()) : null;
                            $("#executor3{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor3{{filho.id_tarefa}}").text()) : null;
                            $("#executor4{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor4{{filho.id_tarefa}}").text()) : null;
                            $("#executor5{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor5{{filho.id_tarefa}}").text()) : null;
                            $("#executor6{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor6{{filho.id_tarefa}}").text()) : null;
                            $("#executor7{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor7{{filho.id_tarefa}}").text()) : null;
                            $("#executor8{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor8{{filho.id_tarefa}}").text()) : null;
                            $("#executor9{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor9{{filho.id_tarefa}}").text()) : null;
                            $("#executor10{{filho.id_tarefa}}").text() != "None" ? executor.push($("#executor10{{filho.id_tarefa}}").text()) : null;
                            
                            for (let i = 0; i < executor.length; i++){
                                if(executor[i] != "---------"){
                                    executores += 1;
                                    if (i <= 1){
                                        $("#filhosExecutores{{filho.id_tarefa}}").html($("#filhosExecutores{{filho.id_tarefa}}").html() + ' <span class="col-xs p-icone executor' + i + ' mr-1" title="Executor: ' + executor[i] +'"><img id="imgExecutor{{filho.id_tarefa}}' + i + '" class="rounded-circle" style="height:100%;width:100%;"></span>');
                                        $("#imgExecutor{{filho.id_tarefa}}" + i).attr("src", "../../media/usuarios/" + executor[i] + "/perfil/" + executor[i] + ".png").on("error", function(){
                                            $("#imgExecutor{{filho.id_tarefa}}" + i).attr("src", "../../media/usuarios/Padrão/perfil/Padrão.png");
                                        });
                                    }
                                }
                            }

                            if (executores > 2){
                                if ((parseInt(executores) - 2) == 1){
                                    $("#filhosExecutores{{filho.id_tarefa}}").html($("#filhosExecutores{{filho.id_tarefa}}").html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + '" style="font-size: 12px;">+' + (parseInt(executores) - 2) + '</span>');
                                } else if ((parseInt(executores) - 2) == 2) {
                                    $("#filhosExecutores{{filho.id_tarefa}}").html($("#filhosExecutores{{filho.id_tarefa}}").html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + '" style="font-size: 12px;">+' + (parseInt(executores) - 2) + '</span>');
                                } else if ((parseInt(executores) - 2) == 3) {
                                    $("#filhosExecutores{{filho.id_tarefa}}").html($("#filhosExecutores{{filho.id_tarefa}}").html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + '" style="font-size: 12px;">+' + (parseInt(executores) - 2) + '</span>');
                                } else if ((parseInt(executores) - 2) == 4) {
                                    $("#filhosExecutores{{filho.id_tarefa}}").html($("#filhosExecutores{{filho.id_tarefa}}").html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\n" + '" style="font-size: 12px;">+' + (parseInt(executores) - 2) + '</span>');
                                } else if ((parseInt(executores) - 2) == 5) {
                                    $("#filhosExecutores{{filho.id_tarefa}}").html($("#filhosExecutores{{filho.id_tarefa}}").html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\nExecutor: " + executor[6] + "\n" + '" style="font-size: 12px;">+' + (parseInt(executores) - 2) + '</span>');
                                } else if ((parseInt(executores) - 2) == 6) {
                                    $("#filhosExecutores{{filho.id_tarefa}}").html($("#filhosExecutores{{filho.id_tarefa}}").html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\nExecutor: " + executor[6] + "\nExecutor: " + executor[7] + "\n" + '" style="font-size: 12px;">+' + (parseInt(executores) - 2) + '</span>');
                                } else if ((parseInt(executores) - 2) == 7) {
                                    $("#filhosExecutores{{filho.id_tarefa}}").html($("#filhosExecutores{{filho.id_tarefa}}").html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\nExecutor: " + executor[6] + "\nExecutor: " + executor[7] + "\nExecutor: " + executor[8] + "\n" + '" style="font-size: 12px;">+' + (parseInt(executores) - 2) + '</span>');
                                } else if ((parseInt(executores) - 2) == 8) {
                                    $("#filhosExecutores{{filho.id_tarefa}}").html($("#filhosExecutores{{filho.id_tarefa}}").html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\nExecutor: " + executor[6] + "\nExecutor: " + executor[7] + "\nExecutor: " + executor[8] + "\nExecutor: " + executor[9] + '" style="font-size: 12px;">+' + (parseInt(executores) - 2) + '</span>');
                                } else {
                                    $("#filhosExecutores{{filho.id_tarefa}}").html("Executores inválidos");
                                }
                            }

                            // Altera imagens da autoridade e responsável
                            pessoaAutoridade = $("#autoridade{{filho.id_tarefa}}").text();
                            $("#imgFAutoridade{{filho.id_tarefa}}").attr("src", "../../media/usuarios/" + pessoaAutoridade + "/perfil/" + pessoaAutoridade + ".png").on("error", function(){
                                $("#imgFAutoridade{{filho.id_tarefa}}").attr("src", "../../media/usuarios/Padrão/perfil/Padrão.png");
                            });
                            $("#fAutoridade{{filho.id_tarefa}}").prop('title', 'Autoridade: ' + pessoaAutoridade);

                            pessoaResponsavel = $("#responsavel{{filho.id_tarefa}}").text();
                            $("#imgFResponsavel{{filho.id_tarefa}}").attr("src", "../../media/usuarios/" + pessoaResponsavel + "/perfil/" + pessoaResponsavel + ".png").on("error", function(){
                                $("#imgFResponsavel{{filho.id_tarefa}}").attr("src", "../../media/usuarios/Padrão/perfil/Padrão.png");
                            });
                            $("#fResponsavel{{filho.id_tarefa}}").prop('title', 'Responsável: ' + pessoaResponsavel);

                        </script>
                    {% endfor %}
                </div>

                <!-- Juridico -->
                <div class="juridico" id="juridico">
                    <!-- Resumo -->
                    <div class="row">
                        <div class="col" id="resumoJuridico">
                            <label for="id_bloco">Resumo:</label>
                            <textarea name="id_resumo_processo" rows="4" id="id_resumo_processo" value="" maxlength="1000">{{juridico.resumo_processo}}</textarea>
                        </div>
                    </div>
                    <!-- Escritório / Advogado / Número Processo / Status -->
                    <div class="row">
                        <div class="col" id="escritorioJuridico">
                            <label for="id_bloco">Escritório:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.escritorio }}
                            </div>
                        </div>
                        <div class="col" id="advogadoEscritorioJuridico">
                            <label for="id_bloco">Advogado Escritório:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.escritorio_advogado }}
                            </div>
                        </div>
                        <div class="col" id="numero_processoJuridico">
                            <label for="id_bloco">Número do Processo:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.numero_processo }}
                            </div>
                        </div>
                        <div class="col" id="statusJuridico">
                            <label for="id_bloco">Status:</label>
                            <span id="id_status_juridico" style="display: none;">{{tarefa.id_status}}</span>
                            <div class="input-group bs-select">
                                <select type="text" name="id_status" id="id_status_juridico1"></select>
                            </div>
                        </div>
                    </div>
                    <!-- Valor Estimado / Valor Causa / Valor Acordo / Prazo -->
                    <div class="row">
                        <div class="col" id="valor_estimadoJuridico">
                            <label for="id_bloco">Valor Estimado:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.valor_estimado }}
                            </div>
                        </div>
                        <div class="col" id="valor_causaJuridico">
                            <label for="id_bloco">Valor da Causa:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.valor_causa }}
                            </div>
                        </div>
                        <div class="col" id="valor_acordoJuridico">
                            <label for="id_bloco">Valor do Acordo:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.valor_acordo }}
                            </div>
                        </div>
                        <div class="col" id="prazo_internoJuridico">
                            <label for="id_bloco">Prazo Interno:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.prazo_interno }}
                            </div>
                        </div>
                    </div>
                    <!-- Perito / Preposto / Torre / Unidade -->
                    <div class="row">
                        <div class="col" id="peritoJuridico">
                            <label for="id_bloco">Perito:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.perito }}
                            </div>
                        </div>
                        <div class="col" id="prepostoJuridico">
                            <label for="id_bloco">Preposto:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.preposto }}
                            </div>
                        </div>
                        <div class="col" id="torreJuridico">
                            <label for="id_bloco">Bloco:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.jBloco }}
                            </div>
                        </div>
                        <div class="col" id="unidadeJuridico">
                            <label for="id_bloco">Unidade:</label>
                            <div class="input-group bs-select">
                                {{ juridico_form.jUnidade }}
                            </div>
                        </div>
                    </div>
                    <!-- Observações -->
                    <div class="row">
                        <div class="col" id="observacoesJuridico">
                            <label for="id_bloco">Observações:</label>
                            <textarea name="id_observacoes" rows="4" id="id_observacoes" value="" maxlength="1000">{{juridico.observacoes}}</textarea>
                        </div>
                    </div>
                    <!-- Autor -->
                    <div style="background-color: #eee; padding: 5px 0;">
                        <div class="row">
                            <div class="col">
                                <label for="autor">Autor:</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-2" id="autor1Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor1 }}
                                </div>
                            </div>
                            <!-- <div class="col-3" id="autor2Autor" style="display: none"> -->
                            <div class="col-2" id="autor2Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor2 }}
                                </div>
                            </div>
                            <!-- <div class="col-3" id="autor3Autor" style="display: none"> -->
                            <div class="col-2" id="autor3Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor3 }}
                                </div>
                            </div>
                            <!-- <div class="col-3" id="autor4Autor" style="display: none"> -->
                            <div class="col-2" id="autor4Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor4 }}
                                </div>
                            </div>
                            <!-- <div class="col-3" id="autor5Autor" style="display: none"> -->
                            <div class="col-2" id="autor5Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor5 }}
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <!-- <div class="col-3" id="autor6Autor" style="display: none"> -->
                            <div class="col-2" id="autor6Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor6 }}
                                </div>
                            </div>
                            <!-- <div class="col-3" id="autor7Autor" style="display: none"> -->
                            <div class="col-2" id="autor7Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor7 }}
                                </div>
                            </div>
                            <!-- <div class="col-3" id="autor8Autor" style="display: none"> -->
                            <div class="col-2" id="autor8Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor8 }}
                                </div>
                            </div>
                            <!-- <div class="col-3" id="autor9Autor" style="display: none"> -->
                            <div class="col-2" id="autor9Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor9 }}
                                </div>
                            </div>
                            <!-- <div class="col-3" id="autor10Autor" style="display: none"> -->
                            <div class="col-2" id="autor10Autor" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ autor_form.autor10 }}
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="assistenteAutorJuridico">
                                <label for="id_bloco">Assistente do Autor:</label>
                                <div class="input-group bs-select">
                                    {{ juridico_form.autor_assistente }}
                                </div>
                            </div>
                            <div class="col" id="advogadoAutorJuridico">
                                <label for="id_bloco">Advogado do Autor:</label>
                                <div class="input-group bs-select">
                                    {{ juridico_form.autor_advogado }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Réu -->
                    <div style="padding: 5px 0;">
                        <div class="row">
                            <div class="col">
                                <label for="autor">Réu:</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-2" id="reu1Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu1 }}
                                </div>
                            </div>
                            <div class="col" id="reu2Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu2 }}
                                </div>
                            </div>
                            <div class="col" id="reu3Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu3 }}
                                </div>
                            </div>
                            <div class="col" id="reu4Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu4 }}
                                </div>
                            </div>
                            <div class="col" id="reu5Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu5 }}
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="reu6Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu6 }}
                                </div>
                            </div>
                            <div class="col" id="reu7Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu7 }}
                                </div>
                            </div>
                            <div class="col" id="reu8Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu8 }}
                                </div>
                            </div>
                            <div class="col" id="reu9Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu9 }}
                                </div>
                            </div>
                            <div class="col" id="reu10Reu" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ reu_form.reu10 }}
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="assistenteReuJuridico">
                                <label for="id_bloco">Assistente do Réu:</label>
                                <div class="input-group bs-select">
                                    {{ juridico_form.reu_assistente }}
                                </div>
                            </div>
                            <div class="col" id="advogadoReuJuridico">
                                <label for="id_bloco">Advogado do Réu:</label>
                                <div class="input-group bs-select">
                                    {{ juridico_form.reu_advogado }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Testemunhas -->
                    <div style="background-color: #eee; padding: 5px 0;">
                        <div class="row">
                            <div class="col">
                                <label for="autor">Testemunhas:</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="testemunha1Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha1 }}
                                </div>
                            </div>
                            <div class="col" id="testemunha2Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha2 }}
                                </div>
                            </div>
                            <div class="col" id="testemunha3Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha3 }}
                                </div>
                            </div>
                            <div class="col" id="testemunha4Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha4 }}
                                </div>
                            </div>
                            <div class="col" id="testemunha5Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha5 }}
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" id="testemunha6Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha6 }}
                                </div>
                            </div>
                            <div class="col" id="testemunha7Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha7 }}
                                </div>
                            </div>
                            <div class="col" id="testemunha8Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha8 }}
                                </div>
                            </div>
                            <div class="col" id="testemunha9Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha9 }}
                                </div>
                            </div>
                            <div class="col" id="testemunha10Testemunhas" style="width: 20%!important; flex: 0 0 20%; max-width: 20%;">
                                <div class="input-group bs-select">
                                    {{ testemunhas_form.testemunha10 }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Histórico -->
                <div class="historico" id="historicoJuridico">
                    {% for tarefa in tarefas %}
                        <span id="historico_tarefas{{tarefa.id_tarefa}}" style="display: none;">{{tarefa.id_status}} i/i {{tarefa.status_pendencia}} h/h {{tarefa.historico}}</span>
                    {% endfor %}
                </div>

                <!-- Modal p/ tela de locação -->
                <div class="modal fade" id="modalLocacao" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Locação</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div id="modal-body-locacao" class="modal-body">
                                <div id="modal-finais">
                                    <div id="modal-finais-esquerdo">
                                        <span id="modal-final-esquerdo">
                                            Finais:
                                        </span>
                                        <input type="radio" name="rd-finais" value="rd-final-esquerdo" checked>
                                    </div>
                                    <div id="modal-finais-direito">
                                        <span id="modal-final-direito">
                                            Finais:
                                        </span>
                                        <input type="radio" name="rd-finais" value="rd-final-direito">
                                    </div>
                                </div>
                                <div id="modal-ambientes">
                                    <div id="modal-cozinha" class="modal-ambiente">
                                        <span>
                                            Cozinha: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | Cozinha"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | Cozinha">
                                        </span>
                                    </div>
                                    <div id="modal-servico" class="modal-ambiente">
                                        <span>
                                            Área de Serviço: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | Área de Serviço"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | Área de Serviço">
                                        </span>
                                    </div>
                                    <div id="modal-lavabo" class="modal-ambiente">
                                        <span>
                                            Lavabo: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Box:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Box | Lavabo"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Chuveiro / Ducha:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Chuveiro | Lavabo"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | Lavabo">
                                        </span>
                                    </div>
                                    <div id="modal-suite" class="modal-ambiente">
                                        <span>
                                            Suíte: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | Suíte"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | Suíte">
                                        </span>
                                    </div>
                                    <div id="modal-suite1" class="modal-ambiente">
                                        <span>
                                            Suíte 1: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | Suíte"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | Suíte 1">
                                        </span>
                                    </div>
                                    <div id="modal-suite2" class="modal-ambiente">
                                        <span>
                                            Suíte 2: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | Suíte"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | Suíte 2">
                                        </span>
                                    </div>
                                    <div id="modal-dormitorio" class="modal-ambiente">
                                        <span>
                                            Dormitório: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | Dormitório"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | Dormitório">
                                        </span>
                                    </div>
                                    <div id="modal-dormitorio1" class="modal-ambiente">
                                        <span>
                                            Dormitório 1: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | Dormitório 1"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | Dormitório 1">
                                        </span>
                                    </div>
                                    <div id="modal-dormitorio2" class="modal-ambiente">
                                        <span>
                                            Dormitório 2: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | Dormitório 2"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | Dormitório 2">
                                        </span>
                                    </div>
                                    <div id="modal-wc-social" class="modal-ambiente">
                                        <span>
                                            WC Social: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Box:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Box | WC Social"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Chuveiro / Ducha:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Chuveiro / Ducha | WC Social"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | WC Social"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | WC Social">
                                        </span>
                                    </div>
                                    <div id="modal-wc-suite" class="modal-ambiente">
                                        <span>
                                            WC Suíte: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Box:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Box | WC Suíte"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Chuveiro / Ducha:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Chuveiro / Ducha | WC Suíte"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | WC Suíte"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | WC Suíte">
                                        </span>
                                    </div>
                                    <div id="modal-wc-suite1" class="modal-ambiente">
                                        <span>
                                            WC Suíte 1: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Box:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Box | WC Suíte 1"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Chuveiro / Ducha:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Chuveiro / Ducha | WC Suíte 1"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | WC Suíte 1"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | WC Suíte 1">
                                        </span>
                                    </div>
                                    <div id="modal-wc-suite2" class="modal-ambiente">
                                        <span>
                                            WC Suíte 2: <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Box:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Box | WC Suíte 2"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Chuveiro / Ducha:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Chuveiro / Ducha | WC Suíte 2"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Luminárias / Spots:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Luminárias / Spots | WC Suíte 2"> <br>
                                        </span>
                                        <span class="modal-opcoes">
                                            Móveis:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Móveis | WC Suíte 2">
                                        </span>
                                    </div>
                                    <div id="modal-aquecedor" class="modal-ambiente">
                                        <span>
                                            Aquecedor:
                                            <input type="checkbox" name="ambientes" class="cb-locacao"
                                                value="Aquecedor"> <br>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer salvarLocacao">
                                <button type="button" class="btn btn-primary" data-dismiss="modal">Salvar</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Fim da modal -->

                <!-- Modal com os valores por tamanho de tarefa. -->
                <div class="modal fade" id="modalTamanho" tabindex="-1" role="dialog"
                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Tamanhos</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th scope="col">Tamanhos</th>
                                            <th scope="col">Pontos e prazos</th>
                                            <th scope="col">Critérios</th>
                                            <th scope="col">Dias trabalhados</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <th scope="row">Baby</th>
                                            <td>0,33</td>
                                            <td>Até 20 minutos</td>
                                            <td>0,04</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">PP</th>
                                            <td>1</td>
                                            <td>Até 1 horas</td>
                                            <td>0,11</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">P</th>
                                            <td>3</td>
                                            <td>De 1 à 3 horas</td>
                                            <td>0,33</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">M</th>
                                            <td>5</td>
                                            <td>De 4 à 5 horas</td>
                                            <td>0,56</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">G</th>
                                            <td>8</td>
                                            <td>De 6 à 8 horas</td>
                                            <td>0,89</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">GG</th>
                                            <td>13</td>
                                            <td>De 9 à 13 horas</td>
                                            <td>1,44</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">EG</th>
                                            <td>21</td>
                                            <td>De 14 à 21 horas</td>
                                            <td>2,33</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Gigante</th>
                                            <td>34</td>
                                            <td>De 22 à 34 horas</td>
                                            <td>3,78</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Gigante 1</th>
                                            <td>55</td>
                                            <td>De 34 à 55 horas</td>
                                            <td>6,11</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Gigante 2</th>
                                            <td>89</td>
                                            <td>De 56 à 89 horas</td>
                                            <td>9,89</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Gigante 3</th>
                                            <td>144</td>
                                            <td>De 90 à 144 horas</td>
                                            <td>13,67</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Gigante 4</th>
                                            <td>233</td>
                                            <td>De 145 à 233 horas</td>
                                            <td>17,44</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Gigante 5</th>
                                            <td>377</td>
                                            <td>De 234 à 377 horas</td>
                                            <td>21,22</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" data-dismiss="modal">Fechar</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Fim da modal -->

                <!-- Modal para duplicar Conservação / Limpeza -->
                <div class="modal fade" id="modalDuplicar" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialig modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Conservação  / Limpeza</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body d-flex">
                                Deseja duplicar a tarefa para <input type="number" name="dias" id="dias" class="form-control form-control-sm"> dias?
                                <input type="checkbox" name="duplicar" class="cb-locacao" value='1'> <br>
                            </div>
                            <div class="modal-footer salvarDuplicar">
                                <button type="button" class="btn btn-primary success" data-dismiss="modal">Sim</button>
                                <button type="button" class="btn btn-primary danger" data-dismiss="modal">Não</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Fim da modal -->

            </div>

            <div id="blocoRodape">
                <div class="row" id="botoes">
                    <div class="col-md-auto salvar">
                        <input class="btn btn-primary" type="submit" value="Salvar edição" id="salvar" />
                    </div>
                    <div class="col-md-auto" id="finalizar">
                        <button type="button" class="btn btn-primary" id="r_finalizar" data-toggle="modal"
                            data-target="#modalConfirmacao">Finalizar retrospectiva</button>
                    </div>
                    <!-- <div class="col-md-auto" id="locacao">
                        <button type="button" class="btn btn-primary" id="l_editar" data-toggle="modal" data-target="#modalLocacao">Editar Locacão</button>
                    </div> -->
                    {% if tarefa.id_filho is not null and tarefa.id_status != 1 %}
                    <div class="col-md-auto">
                            <a class="btn btn-primary" id="filhos" target="_blank" href="{% url 'Tarefa:filhos' tarefa.id_tarefa %}">Adicionar filho</a>
                    </div>
                    {% endif %}
                    {% if tarefa.id_filho is null %}
                    <div class="col-md-auto">
                            <a class="btn btn-primary" id="filhos" target="_blank" href="{% url 'Tarefa:filhos' tarefa.id_tarefa %}">Adicionar filho</a>
                    </div>
                    {% endif %}
                    <div class="col-md-auto">
                        <button class="btn btn-primary" id="duplicar">
                            <a target="_blank" href="{% url 'Tarefa:duplicar' tarefa.id_tarefa %}">Duplicar tarefa</a>
                        </button>
                    </div>
                    <div class="col-md-auto">
                        <button class="btn btn-primary" id="novaTarefa">
                            <a target="_blank" href="{% url 'Tarefa:cadastrar' %}">Nova tarefa</a>
                        </button>
                    </div>
                    <div class="col-md-auto" id="impressao">
                        <button class="btn btn-primary">
                            <a target="_blank" href="{% url 'Solicitacao:impressao' tarefa.id_tarefa %}">
                                <i class="fas fa-print"></i>
                                Imprimir
                            </a>
                        </button>
                    </div>
                </div>

                <!-- Modal -->
                <div class="modal fade" id="modalConfirmacao" tabindex="-1" role="dialog"
                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <center>
                                    <h5 class="modal-title" id="exampleModalLabel">Confirmação:</h5>
                                </center>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <center>Deseja finalizar a retrospectiva?<br>A edição será bloqueada após a finalização!
                                </center>
                            </div>
                            <div class="modal-footer">
                                <center>
                                    <button type="button" class="btn btn-primary" id="mFinalizar">Sim</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Não</button>
                                </center>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </form>
    </div>
</div>
{% endblock %}

{% block navbar %}
    {% if tarefa.id_filho is not null and tarefa.id_status != 1 %}
        <div style="margin-left: 15px!important;">
            <button id="exportar" type="button" class="btn btn-info" onclick="download()">
                <i class="fa fa-download"></i>
                <span >Exportar</span>
            </button>
        </div>

        <a 
            id="importar" 
            type="button" 
            class="btn btn-info ml-3" 
            href="{% url 'Tarefa:importarMaeFilho'%}"
            target="_blank"
        >
            <i class="fa fa-upload"></i>
            <span >Importar</span>
        </a>
    {% endif %}
    
    <div class="noselect" id="trocarEdicao">
        <span class="trocarEdicao" id="trocarTarefa" title="Ir para: Tarefa">Tarefa</span>
        <h5 class="barraEdicao" style="display: none;">|</h5>
        <span class="trocarEdicao" id="trocarAnexo" title="Ir para: Anexo" style="display: none;" >Anexo</span>
        <h5 class="barraEdicao" id="barraMae">|</h5>
        <span class="trocarEdicao" id="trocarMae" title="Ir para: Mãe" onclick="editarTarefa({{tarefa.id_filho}})">Mãe</span>
        <h5 class="barraEdicao" id="barraFilho">|</h5>
        <span class="trocarEdicao" id="trocarFilho" title="Ir para: Filhos">Filhos</span>
        <h5 class="barraEdicao" id="barraRetrospectiva">|</h5>
        <span class="trocarEdicao" id="trocarRetrospectiva" title="Ir para: Retrospectiva">Retrospectiva</span>
        <h5 class="barraEdicao" id="barra5w2h">|</h5>
        <span class="trocarEdicao" id="trocar5w2h" title="Ir para: 5w2h">5W2H</span>
        <h5 class="barraEdicao" id="barraSat">|</h5>
        <span class="trocarEdicao" id="trocarSat" title="Ir para: Solicitação de Assistência Técnica">SAT</span>
        <h5 class="barraEdicao" id="barraLocacao">|</h5>
        <span class="trocarEdicao" id="trocarLocacao" title="Ir para: Locação">Locação</span>
        <h5 class="barraEdicao" id="barraMedicaoTerceiros">|</h5>
        <span class="trocarEdicao" id="trocarMedicaoTerceiros" title="Ir para: Medição Terceiros">Medição Terceiros</span>
        <h5 class="barraEdicao" id="barraJuridico">|</h5>
        <span class="trocarEdicao" id="trocarJuridico" title="Ir para: Jurídico">Jurídico</span>
        <h5 class="barraEdicao" id="barraHistorico">|</h5>
        <span class="trocarEdicao" id="trocarHistorico" title="Ir para: Histórico">Histórico</span>
    </div>

{% endblock %}

{% block expandirFiltros %}

<div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
  <div class="card-body">
      <form class="" action="" id="form" method="GET">
        <input 
            id="tarefa-maae" 
            value="{{tarefa.id_filho}}" 
            type="text" 
            class="input-sm form-control" 
            name="tarefa-mae" 
            autocomplete="off" 
        />
    </form>
  </div>
</div>

{% endblock %}

{% block scripts %}

<!-- JS do campo executor -->
<script src="{% static 'Tarefa/js/executores.js' %}"></script>
<!-- JS da exibição da tela -->
<script src="{% static 'Tarefa/js/exibirTarefa.js' %}"></script>

<script>
    //Altera tipo do campo porcentagem para numérico
    $(function () {
        $("#id_porcentagem.form-control.form-control-sm").prop("type", "number");

        //Criação de variável temporária para guardar último impedimento
        let temporario;
        $("#id_stat").change(function () {
            //Se Status for alterado para Feito
            if ($("#id_stat").val() == 'Feito') {
                //Guarda impedimento na variável e limpa campo impedimento
                temporario = $("#id_pendente_por").val();
                $("#id_pendente_por").val("");
            } else {
                //Se outro Status for selecionado impedimento recebe o valor antigo
                $("#id_pendente_por").val(temporario);
            }
        });
    });

    function editarTarefa(id_tarefa){
        url = "{% url 'Tarefa:URL_editarTarefa' %}"
        window.open(url+id_tarefa);
    }
</script>

<script>
    $('#id_tarefa').addClass('form-control form-control-sm')
    $('#id_rtarefa').addClass('form-control form-control-sm')
    $('#id_wTarefa').addClass('form-control form-control-sm')

    $('#id_id_departamento').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_id_centro_custo').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_prioridade').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_stat').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_id_tamanho').addClass('custom-select custom-select form-control form-control-sm')

    $('#id_prazo').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_etapa').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_subetapa').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_autoridade').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_responsavel').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_checado').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_satisfacao_avaliacao').addClass('custom-select custom-select form-control form-control-sm')

    $('#id_data_ini').addClass('form-control form-control-sm')
    $('#id_data_ini').attr('autocomplete', 'off')

    $('#id_data_real').addClass('form-control form-control-sm')
    $('#id_data_real').attr('autocomplete', 'off')
    $('#id_data_real').attr('readonly', 'true')

    $('#id_data_fim').addClass('form-control form-control-sm')
    $('#id_data_fim').attr('autocomplete', 'off')
    $('#id_data_fim').attr('readonly', 'true')

    $('#id_data_finalizacao').addClass('form-control form-control-sm')
    $('#id_data_finalizacao').attr('autocomplete', 'off')
    $('#id_data_finalizacao').attr('readonly', 'true')

    $('#id_pendente_por').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_processo_relacionado').addClass('custom-select custom-select form-control form-control-sm')

    $('#id_r5w2hT').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_retrospec').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_calendario').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_data_calendario').addClass('form-control form-control-sm')
    $('#id_data_calendario').attr('autocomplete', 'off')

    $('.executor > select').addClass('custom-select custom-select form-control form-control-sm')

    $('#porcentagem-executor > input').addClass('form-control form-control-sm')
    $('#porcentagem-executor > input').attr("onkeypress", "return event.charCode >= 48 && event.charCode <= 57")

    $('#id_porcentagem').addClass('form-control form-control-sm')
    $('#id_porcentagem').attr("min", "0")
    $('#id_porcentagem').attr("max", "100")
    $('#id_porcentagem').attr("maxlength", "3")
    $('#id_porcentagem').attr("type", "text")
    $('#id_porcentagem').attr("onkeypress", "return event.charCode >= 48 && event.charCode <= 57")

    // Retrospectiva
    $('#id_rTarefa').addClass('form-control form-control-sm')
    $('#id_rStat').addClass('form-control form-control-sm')
    $('#id_id_responsavel').addClass('form-control form-control-sm')
    $('#id_retrospectiva').addClass('form-control form-control-sm')

    // 5W2H
    $('#id_rWhat').addClass('form-control form-control-sm')
    $('#id_rWhy').addClass('form-control form-control-sm')
    $('#id_rWhere').addClass('form-control form-control-sm')
    $('#id_rWhen').addClass('form-control form-control-sm')
    $('#id_rWho').addClass('form-control form-control-sm')
    $('#id_rHow').addClass('form-control form-control-sm')
    $('#id_rHowMuch').addClass('form-control form-control-sm')

    // Locação
    $('#id_id_centro_custo1').addClass('form-control form-control-sm')
    $('#id_lBloco').addClass('form-control form-control-sm')
    $('#id_lUnidade').addClass('form-control form-control-sm')

    // Medição Terceiros
    $('#id_id_medicao').addClass('form-control form-control-sm')
    $('#id_mes').addClass('form-control form-control-sm')
    $('#id_valor_bruto').addClass('form-control form-control-sm')
    $('#id_valor_liquido').addClass('form-control form-control-sm')
    $('#id_permuta').addClass('form-control form-control-sm')

    // Solicitação de Assistência Técnica
    //JS para esconder o solicitante
    $('#id_id_departamento').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_id_centro_custo').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_prioridade').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_stat').addClass('custom-select custom-select form-control form-control-sm')

    $('#id_autoridade_sat').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_responsavel_sat').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_status_processo').addClass('custom-select custom-select form-control form-control-sm')

    $('#id_porcentagem_sat').addClass('form-control form-control-sm')
    $('#id_porcentagem_sat').attr("min", "0")
    $('#id_porcentagem_sat').attr("max", "100")
    $('#id_porcentagem_sat').attr("maxlength", "3")
    $('#id_porcentagem_sat').attr("type", "text")
    $('#id_porcentagem_sat').attr("onkeypress", "return event.charCode >= 48 && event.charCode <= 57")

    $('#id_data_abertura').addClass('form-control form-control-sm')
    $('#id_data_abertura').attr('autocomplete', 'off')
    $('#id_data_atendimento').addClass('form-control form-control-sm')
    $('#id_data_atendimento').attr('autocomplete', 'off')
    $('#id_data_finalizacao_sat').addClass('form-control form-control-sm')
    $('#id_data_finalizacao_sat').attr('autocomplete', 'off')
    $('#id_data_entrega').addClass('form-control form-control-sm')
    $('#id_data_entrega').attr('autocomplete', 'off')

    $('#id_processo_relacionado_sat').addClass('custom-select custom-select form-control form-control-sm')
    $('#id_tipo_solicitacao').addClass('custom-select custom-select form-control form-control-sm')

    $('#id_ambiente').addClass('ambi')
    $('#id_descricao_sat').addClass('descricao_problema')
    $('#id_tipo_reparo').addClass('tipo_reparo')
    $('#id_procedencia').addClass('procedencia')
    $('#id_historico_sat').addClass('historico_sat')
    $('#id_estimativa_custo').addClass('custo')
    $('#id_material').addClass('material')
    
    // Juridico
    $('#id_resumo_processo').addClass('form-control form-control-sm')
    $('#id_escritorio').addClass('form-control form-control-sm')
    $('#id_numero_processo').addClass('form-control form-control-sm')
    $('#id_id_status').addClass('form-control form-control-sm')
    $('#id_prazo_interno').addClass('form-control form-control-sm')
    $('#id_valor_estimado').addClass('form-control form-control-sm')
    $('#id_valor_causa').addClass('form-control form-control-sm')
    $('#id_valor_acordo').addClass('form-control form-control-sm')
    $('#id_perito').addClass('form-control form-control-sm')
    $('#id_preposto').addClass('form-control form-control-sm')
    $('#id_jBloco').addClass('form-control form-control-sm')
    $('#id_jUnidade').addClass('form-control form-control-sm')
    $('#id_observacoes').addClass('form-control form-control-sm')
    $('#id_escritorio_advogado').addClass('form-control form-control-sm')
    $('#id_autor1').addClass('form-control form-control-sm')
    $('#id_autor2').addClass('form-control form-control-sm')
    $('#id_autor3').addClass('form-control form-control-sm')
    $('#id_autor4').addClass('form-control form-control-sm')
    $('#id_autor5').addClass('form-control form-control-sm')
    $('#id_autor6').addClass('form-control form-control-sm')
    $('#id_autor7').addClass('form-control form-control-sm')
    $('#id_autor8').addClass('form-control form-control-sm')
    $('#id_autor9').addClass('form-control form-control-sm')
    $('#id_autor10').addClass('form-control form-control-sm')
    $('#id_autor_assistente').addClass('form-control form-control-sm')
    $('#id_autor_advogado').addClass('form-control form-control-sm')
    $('#id_reu1').addClass('form-control form-control-sm')
    $('#id_reu2').addClass('form-control form-control-sm')
    $('#id_reu3').addClass('form-control form-control-sm')
    $('#id_reu4').addClass('form-control form-control-sm')
    $('#id_reu5').addClass('form-control form-control-sm')
    $('#id_reu6').addClass('form-control form-control-sm')
    $('#id_reu7').addClass('form-control form-control-sm')
    $('#id_reu8').addClass('form-control form-control-sm')
    $('#id_reu9').addClass('form-control form-control-sm')
    $('#id_reu10').addClass('form-control form-control-sm')
    $('#id_reu_assistente').addClass('form-control form-control-sm')
    $('#id_reu_advogado').addClass('form-control form-control-sm')
    $('#id_testemunha1').addClass('form-control form-control-sm')
    $('#id_testemunha2').addClass('form-control form-control-sm')
    $('#id_testemunha3').addClass('form-control form-control-sm')
    $('#id_testemunha4').addClass('form-control form-control-sm')
    $('#id_testemunha5').addClass('form-control form-control-sm')
    $('#id_testemunha6').addClass('form-control form-control-sm')
    $('#id_testemunha7').addClass('form-control form-control-sm')
    $('#id_testemunha8').addClass('form-control form-control-sm')
    $('#id_testemunha9').addClass('form-control form-control-sm')
    $('#id_testemunha10').addClass('form-control form-control-sm')

</script>

<script>
    $('#id_data_ini').datepicker({
        todayBtn: "linked",
        language: "pt-BR",
        daysOfWeekDisabled: "0,6",
        daysOfWeekHighlighted: "1,2,3,4,5",
        autoclose: true,
        todayHighlight: true
    });

    $('#id_data_abertura').datepicker({
        todayBtn: "linked",
        language: "pt-BR",
        daysOfWeekDisabled: "0,6",
        daysOfWeekHighlighted: "1,2,3,4,5",
        autoclose: true,
        todayHighlight: true
    });

    $('#id_data_atendimento').datepicker({
        todayBtn: "linked",
        language: "pt-BR",
        daysOfWeekDisabled: "0,6",
        daysOfWeekHighlighted: "1,2,3,4,5",
        autoclose: true,
        todayHighlight: true
    });

    $('#id_data_finalizacao_sat').datepicker({
        todayBtn: "linked",
        language: "pt-BR",
        daysOfWeekDisabled: "0,6",
        daysOfWeekHighlighted: "1,2,3,4,5",
        autoclose: true,
        todayHighlight: true
    });

    $('#id_data_entrega').datepicker({
        todayBtn: "linked",
        language: "pt-BR",
        daysOfWeekDisabled: "0,6",
        daysOfWeekHighlighted: "1,2,3,4,5",
        autoclose: true,
        todayHighlight: true
    });

    $('#id_data_calendario').dateTimePicker();
    
    $('#id_calendario').val() == 0 ? $("#data_calendario").css('display', 'none') : $("#data_calendario").css('display', 'block');

    if($('#id_calendario').val() == 1 ){
        let result = $("#result").val().split(', '), formatted_date = result[0].split('/');
        $("#id_date_calendario").text(result[0]);
        $("#id_hora_calendario").text(result[1]);
        $("#result").val(`${formatted_date[2]}-${formatted_date[1]}-${formatted_date[0]} ${result[1]}`);
    }

    $('#id_calendario').change(() => {
        $('#id_calendario').val() == 0 ? $("#data_calendario").css('display', 'none') : $("#data_calendario").css('display', 'block');
        if($('#id_calendario').val() == 1 ){
            let data = $("#id_date_calendario").text().split('-');
            let hora = $("#id_hora_calendario").text().split(':');
            $("#result").val(`${data[0]}-${data[1]}-${data[2]} ${hora[0]}:${hora[1]}:00`);
        }
    })
    
    $("#result").val() == 'None' ? $("#result").val(null) : null;
    $("#result").val() == 'undefined-undefined-None undefined:undefined:undefined' ? $("#result").val('') : null;
    
    $('#id_prazo_interno').datepicker({
    todayBtn: "linked",
    language: "pt-BR",
    daysOfWeekDisabled: "0,6",
    daysOfWeekHighlighted: "1,2,3,4,5",
    autoclose: true,
    todayHighlight: true
    });

    function dataFinal() {
        var prazo = parseInt(document.getElementById('id_prazo').value)

        if ((document.getElementById('id_stat').value != 'Feito') && (document.getElementById('id_stat').value != 'Cancelado')) {
            var arrDataReal = document.getElementById('id_data_real').value.split('/');
            var stringFormatada = arrDataReal[1] + '-' + arrDataReal[0] + '-' + arrDataReal[2];
            var data_real = new Date(stringFormatada);

            data_real.setDate(data_real.getDate() + parseInt(prazo));

            var dia = data_real.getDate();
            var mes = data_real.getMonth() + 1;
            var ano = data_real.getFullYear();

            if (parseInt(dia) < 10) {
                dia = '0' + dia;
            }

            if (parseInt(mes) < 10) {
                mes = '0' + mes;
            }

            document.getElementById('id_data_fim').value = dia + "/" + mes + "/" + ano;
        }
    }

    function dataReal() {
        var data_inicial = document.getElementById('id_data_ini').value;

        $('#id_data_real').datepicker('destroy');

        $('#id_data_real').datepicker({
            startDate: data_inicial,
            todayBtn: "linked",
            language: "pt-BR",
            daysOfWeekDisabled: "0,6",
            daysOfWeekHighlighted: "1,2,3,4,5",
            autoclose: true,
            todayHighlight: true
        });

        var arrDataIni = document.getElementById('id_data_ini').value.split('/');
        var stringFormatada = arrDataIni[1] + '-' + arrDataIni[0] + '-' + arrDataIni[2];
        var data_ini = new Date(stringFormatada);
        $('#id_data_real').datepicker('setDate', data_ini);

        $('#id_data_real').datepicker('destroy');

    }

    function habilitarDataFinal() {
        var data_fim = document.getElementById('id_data_fim');
        data_fim.removeAttribute('readonly');
        $('#id_data_fim').datepicker('destroy');

        var data_real = document.getElementById('id_data_real').value;

        $('#id_data_fim').datepicker({
            startDate: data_real,
            todayBtn: "linked",
            language: "pt-BR",
            daysOfWeekDisabled: "0,6",
            daysOfWeekHighlighted: "1,2,3,4,5",
            autoclose: true,
            todayHighlight: true
        });

        var hoje = new Date();
        $('#id_data_fim').datepicker('setDate', hoje);
    }

    function habilitarDataReal() {
        var data_real = document.getElementById('id_data_real');
        data_real.removeAttribute('readonly');
        $('#id_data_real').datepicker('destroy');

        var data_ini = document.getElementById('id_data_ini').value;

        $('#id_data_real').datepicker({
            startDate: data_ini,
            todayBtn: "linked",
            language: "pt-BR",
            daysOfWeekDisabled: "0,6",
            daysOfWeekHighlighted: "1,2,3,4,5",
            autoclose: true,
            todayHighlight: true
        });
    }

    function desabilitarDataFinal() {
        $('#id_data_fim').attr('readonly', 'true');
        $('#id_data_fim').datepicker('destroy');
    }

    function desabilitarDataReal() {
        $('#id_data_real').attr('readonly', 'true');
        $('#id_data_real').datepicker('destroy');
    }

    var data_ini_antiga = document.getElementById('id_data_ini').value;
    var data_ini_nova = document.getElementById('id_data_ini').value;

    function ControlTimerDataIni() {
        data_ini_nova = document.getElementById('id_data_ini').value;
        if (data_ini_nova != data_ini_antiga) {
            dataReal();
            dataFinal();
            data_ini_antiga = data_ini_nova;
        }

        setTimeout("ControlTimerDataIni()", 100)
    }
    ControlTimerDataIni()

    var data_real_antiga = document.getElementById('id_data_real').value;
    var data_real_nova = document.getElementById('id_data_real').value;

    function ControlTimerDataReal() {
        data_real_nova = document.getElementById('id_data_real').value;
        if (data_real_nova != data_real_antiga) {
            dataFinal();
            if (document.getElementById('id_stat').value == 'Feito') {
                habilitarDataFinal();
                habilitarDataReal();
            }
            data_real_antiga = data_real_nova;
        }

        setTimeout("ControlTimerDataReal()", 100)
    }
    ControlTimerDataReal()

    var prazo_antigo = document.getElementById('id_prazo').value;
    var prazo_novo = document.getElementById('id_prazo').value;

    function ControlTimerPrazo() {
        prazo_novo = document.getElementById('id_prazo').value;
        if (prazo_novo != prazo_antigo) {
            dataFinal();
            prazo_antigo = prazo_novo;
        }

        setTimeout("ControlTimerPrazo()", 100)
    }
    ControlTimerPrazo()

    var status_antigo = document.getElementById('id_stat').value;
    var status_novo = document.getElementById('id_stat').value;

    function ControlTimerStatus() {
        status_novo = document.getElementById('id_stat').value;
        porcentagem = document.getElementById('id_porcentagem');
        if (status_novo != status_antigo) {
            if (status_novo == 'A fazer') {
                porcentagem.value = 0;
                dataFinal();
                desabilitarDataFinal();
                dataReal();
                desabilitarDataReal();
            } else if (status_novo == 'Fazendo') {
                porcentagem.value = 1;
                dataFinal();
                desabilitarDataFinal();
                dataReal();
                desabilitarDataReal();
            } else if (status_novo == 'Feito') {
                porcentagem.value = 100;
                habilitarDataFinal();
                habilitarDataReal();
            }
            status_antigo = status_novo;
        }

        setTimeout("ControlTimerStatus()", 100)
    }
    ControlTimerStatus()

    var porcentagem_nova = parseInt(document.getElementById('id_porcentagem').value);
    var porcentagem_antiga = parseInt(document.getElementById('id_porcentagem').value);
    var porcentagem = document.getElementById('id_porcentagem');

    function ControlTimerPorcentagem() {
        porcentagem_nova = parseInt(document.getElementById('id_porcentagem').value);

        if (porcentagem_nova != porcentagem_antiga) {
            if (porcentagem_nova > 100) {
                if (document.getElementById('id_stat').value == 'A fazer') {
                    porcentagem.value = 0;
                } else if (document.getElementById('id_stat').value == 'Fazendo') {
                    porcentagem.value = 1;
                } else if (document.getElementById('id_stat').value == 'Feito') {
                    porcentagem.value = 100;
                }
            } else if (porcentagem_nova < 0) {
                if (document.getElementById('id_stat').value == 'A fazer') {
                    porcentagem.value = 0;
                } else if (document.getElementById('id_stat').value == 'Fazendo') {
                    porcentagem.value = 1;
                } else if (document.getElementById('id_stat').value == 'Feito') {
                    porcentagem.value = 100;
                }
            } else if (porcentagem_nova >= 0 && porcentagem_nova <= 100) {
                if (document.getElementById('id_stat').value == 'A fazer') {
                    porcentagem.value = 0;
                } else if (document.getElementById('id_stat').value == 'Fazendo') {
                    if (porcentagem_nova == 0 || porcentagem_nova == 00 || porcentagem_nova == 000) {
                        porcentagem.value = 1;
                    } else if (porcentagem_nova === 100) {
                        porcentagem.value = 99;
                    }
                } else if (document.getElementById('id_stat').value == 'Feito') {
                    porcentagem.value = 100;
                }
            }
            porcentagem_antiga = porcentagem_nova;
        }

        setTimeout("ControlTimerPorcentagem()", 100)
    }
    ControlTimerPorcentagem()

    var porcentagem_executor1 = document.getElementById('id_porcento1')
    var porcentagem_executor2 = document.getElementById('id_porcento2')
    var porcentagem_executor3 = document.getElementById('id_porcento3')
    var porcentagem_executor4 = document.getElementById('id_porcento4')
    var porcentagem_executor5 = document.getElementById('id_porcento5')
    var porcentagem_executor6 = document.getElementById('id_porcento6')
    var porcentagem_executor7 = document.getElementById('id_porcento7')
    var porcentagem_executor8 = document.getElementById('id_porcento8')
    var porcentagem_executor9 = document.getElementById('id_porcento9')
    var porcentagem_executor10 = document.getElementById('id_porcento10')

    function ControlTimerPorcentagemExecutor() {

        porcentagem_executor1 = document.getElementById('id_porcento1')

        if (parseInt(porcentagem_executor1.value) > 100) {
            porcentagem_executor1.value = 100;
        } else if (parseInt(porcentagem_executor1.value) < 0) {
            porcentagem_executor1.value = 0;
        }

        porcentagem_executor2 = document.getElementById('id_porcento2')

        if (parseInt(porcentagem_executor2.value) > 100) {
            porcentagem_executor2.value = 100;
        } else if (parseInt(porcentagem_executor2.value) < 0) {
            porcentagem_executor2.value = 0;
        }

        porcentagem_executor3 = document.getElementById('id_porcento3')

        if (parseInt(porcentagem_executor3.value) > 100) {
            porcentagem_executor3.value = 100;
        } else if (parseInt(porcentagem_executor3.value) < 0) {
            porcentagem_executor3.value = 0;
        }

        porcentagem_executor4 = document.getElementById('id_porcento4')

        if (parseInt(porcentagem_executor4.value) > 100) {
            porcentagem_executor4.value = 100;
        } else if (parseInt(porcentagem_executor4.value) < 0) {
            porcentagem_executor4.value = 0;
        }

        porcentagem_executor5 = document.getElementById('id_porcento5')

        if (parseInt(porcentagem_executor5.value) > 100) {
            porcentagem_executor5.value = 100;
        } else if (parseInt(porcentagem_executor5.value) < 0) {
            porcentagem_executor5.value = 0;
        }

        porcentagem_executor6 = document.getElementById('id_porcento6')

        if (parseInt(porcentagem_executor6.value) > 100) {
            porcentagem_executor6.value = 100;
        } else if (parseInt(porcentagem_executor6.value) < 0) {
            porcentagem_executor6.value = 0;
        }

        porcentagem_executor7 = document.getElementById('id_porcento7')

        if (parseInt(porcentagem_executor7.value) > 100) {
            porcentagem_executor7.value = 100;
        } else if (parseInt(porcentagem_executor7.value) < 0) {
            porcentagem_executor7.value = 0;
        }

        porcentagem_executor8 = document.getElementById('id_porcento8')

        if (parseInt(porcentagem_executor8.value) > 100) {
            porcentagem_executor8.value = 100;
        } else if (parseInt(porcentagem_executor8.value) < 0) {
            porcentagem_executor8.value = 0;
        }

        porcentagem_executor9 = document.getElementById('id_porcento9')

        if (parseInt(porcentagem_executor9.value) > 100) {
            porcentagem_executor9.value = 100;
        } else if (parseInt(porcentagem_executor9.value) < 0) {
            porcentagem_executor9.value = 0;
        }

        porcentagem_executor10 = document.getElementById('id_porcento10')

        if (parseInt(porcentagem_executor10.value) > 100) {
            porcentagem_executor10.value = 100;
        } else if (parseInt(porcentagem_executor10.value) < 0) {
            porcentagem_executor10.value = 0;
        }

        setTimeout("ControlTimerPorcentagemExecutor()", 100)
    }
    ControlTimerPorcentagemExecutor()
</script>

<script>
    function sleep(milliseconds) {
        var start = new Date().getTime();
        for (var i = 0; i < 1e7; i++) {
            if ((new Date().getTime() - start) > milliseconds) {
                break;
            }
        }
    }
    //Codigo do Loading
    $(document).ready(function () {
        sleep(1500);
        document.getElementById("load").classList.toggle('esconder');
        document.getElementById("conteudo").classList.toggle('mostrar');
        $("#load").attr("hidden", true);

    });
</script>

<!--Script para fade do alerta-->
<script>
    $(document).ready(function () {
        $('#alert-tarefa').fadeOut(1500);
    });
</script>

<script>
    function removerElementos(select) {
        //Removendo todos option atualmente na combo
        while (select.length != 1) {
            select.remove(select.length - 1);
        }

        $(select).attr('readonly', 'true');
    }

    var ccSelect = document.getElementById('id_id_centro_custo');

    var cc_antigo = ccSelect.options[ccSelect.selectedIndex].value;
    var cc_novo = ccSelect.options[ccSelect.selectedIndex].value;

    function ControlCC() {
        var cc_novo = ccSelect.options[ccSelect.selectedIndex].value;
        var selectEtapa = document.getElementById('id_etapa');

        if (cc_antigo != cc_novo) {
            if (ccSelect.selectedIndex == 0) {
                removerElementos(selectEtapa);
                cc_antigo = cc_novo;
            } else {
                cc_antigo = cc_novo;

                url = "{% url 'Tarefa:getEtapa' %}"
                url_completa = url + cc_novo

                $.ajax({
                    type: 'GET',
                    url: url_completa,
                    dataType: 'json',
                    success: function (data) {
                        var etapas = JSON.parse(data);

                        removerElementos(selectEtapa);

                        // Preenchendo a combos com as etapa vinculadas ao CC escolhido
                        for (indice in etapas) {
                            var elem = document.createElement('option')
                            elem.value = etapas[indice].pk;
                            elem.text = etapas[indice].fields.etapa;
                            selectEtapa.add(elem, selectEtapa.options[indice + 1]);
                        }

                        $(selectEtapa).removeAttr('readonly');

                    },
                });
            }
        }

        setTimeout("ControlCC()", 100)
    }
    ControlCC()

    $("#id_id_centro_custo1").val($("#id_id_centro_custo").val());

    $("#id_id_centro_custo1").change(() => {
        $("#id_id_centro_custo").val($("#id_id_centro_custo1").val());
    })

    $("#id_id_centro_custo1").change(() => {
        $("#id_id_centro_custo1").val($("#id_id_centro_custo").val());
    })

    var etapaSelect = document.getElementById('id_etapa');

    var etapa_antigo = etapaSelect.options[etapaSelect.selectedIndex].value;
    var etapa_novo = etapaSelect.options[etapaSelect.selectedIndex].value;

    function ControlEtapa() {
        var etapa_novo = etapaSelect.options[etapaSelect.selectedIndex].value;
        var selectSubEtapa = document.getElementById('id_subetapa');

        if (etapa_antigo != etapa_novo) {
            if (etapaSelect.selectedIndex == 0) {
                removerElementos(selectSubEtapa);
                etapa_antigo = etapa_novo;
            } else {
                etapa_antigo = etapa_novo;

                url = "{% url 'Tarefa:getSubEtapa' %}"
                url_completa = url + etapa_novo

                $.ajax({
                    type: 'GET',
                    url: url_completa,
                    dataType: 'json',
                    success: function (data) {
                        var subetapas = JSON.parse(data);

                        removerElementos(selectSubEtapa);

                        // Preenchendo a combos com as etapa vinculadas ao CC escolhido
                        for (indice in subetapas) {
                            var elem = document.createElement('option')
                            elem.value = subetapas[indice].pk;
                            elem.text = subetapas[indice].fields.sub_etapa;
                            selectSubEtapa.add(elem, selectSubEtapa.options[indice + 1]);
                        }

                        $(selectSubEtapa).removeAttr('readonly');

                    },
                    error: function () {
                        alert('deu ruim');
                    }
                });
            }
        }

        setTimeout("ControlEtapa()", 100)
    }
    ControlEtapa()

    function ControlR5w2h() {
        try{
            var id = $("#id_tarefa").val();
            url = "{% url 'Tarefa:getR5w2h' %}"
            url_completa = url + id

            $.ajax({
                type: 'GET',
                url: url_completa,
                dataType: 'json',
                success: function (data) {
                    var retrospectivas = JSON.parse(data);
                    if (retrospectivas.length > 0) {
                        $("#id_rWhat").val(retrospectivas[0].fields.rWhat);
                        $("#id_rWhy").val(retrospectivas[0].fields.rWhy);
                        $("#id_rWhere").val(retrospectivas[0].fields.rWhere);
                        $("#id_rWhen").val(retrospectivas[0].fields.rWhen);
                        $("#id_rWho").val(retrospectivas[0].fields.rWho);
                        $("#id_rHow").val(retrospectivas[0].fields.rHow);
                        $("#id_rHowMuch").val(retrospectivas[0].fields.rHowMuch);
                    }
                },
                error: function () {
                    alert('Erro ao buscar dados do 5W2H');
                }
            });
        } catch{
            null
        }
    }
    ControlR5w2h();
    if ($("#id_r5w2hT").val() != 0) {
        $("#id_rWhat").prop("required", true);
        $("#id_rWhy").prop("required", true);
        $("#id_rWhere").prop("required", true);
        $("#id_rWhen").prop("required", true);
        $("#id_rWho").prop("required", true);
        $("#id_rHow").prop("required", true);
        $("#id_rHowMuch").prop("required", true);
    }
    $("#id_r5w2hT").change(function () {
        if ($("#id_r5w2hT").val() != 0) {
            $("#id_rWhat").prop("required", true);
            $("#id_rWhy").prop("required", true);
            $("#id_rWhere").prop("required", true);
            $("#id_rWhen").prop("required", true);
            $("#id_rWho").prop("required", true);
            $("#id_rHow").prop("required", true);
            $("#id_rHowMuch").prop("required", true);
        } else{
            $("#id_rWhat").removeAttr("required");
            $("#id_rWhy").removeAttr("required");
            $("#id_rWhere").removeAttr("required");
            $("#id_rWhen").removeAttr("required");
            $("#id_rWho").removeAttr("required");
            $("#id_rHow").removeAttr("required");
            $("#id_rHowMuch").removeAttr("required");
        }
    });

    function ControlRetrospectiva() {
        var id = $("#id_tarefa").val();
        url = "{% url 'Tarefa:getRetrospectiva' %}"
        url_completa = url + id

        try{
            $.ajax({
                type: 'GET',
                url: url_completa,
                dataType: 'json',
                success: function (data) {
                    var retrospectivas = JSON.parse(data);
                    if (retrospectivas.length > 0) {
                        $("#id_classificacao").val(retrospectivas[0].fields.descricao);
                        $("#id_rStat").val(retrospectivas[0].fields.stats);
                        $("#id_id_responsavel").val(retrospectivas[0].fields.id_responsavel);
                        $("#id_rHistorico").val(retrospectivas[0].fields.r_historico);
                        retrospectivas[0].fields.finalizado == true ? $("#id_finalizado").val(1) : $("#id_finalizado").val(0);

                        if (retrospectivas[0].fields.finalizado != false) {
                            $("#rFinalizar").hide();
                            $('#id_classificacao').attr('readonly', 'readonly');
                            $('#id_rStat').prop("readonly", "readonly");
                            $('#id_id_responsavel').prop("readonly", "readonly");
                            $("#id_retrospectiva").prop("readonly", "readonly");
                            $("#id_retrospec").prop("readonly", "readonly");
                            $('#id_rHistorico').attr('readonly', 'readonly');
                        }
                    }
                },
                error: function () {
                    alert('Erro ao buscar dados da Retrospectiva');
                }
            });
        } catch{
            null
        }
    }
    ControlRetrospectiva();
    if ($("#id_retrospec").val() != 0) {
        $("#id_classificacao").prop("required", true);
        $("#id_id_responsavel").prop("required", true);
    }
    $("#id_retrospec").change(function () {
        if ($("#id_retrospec").val() != 0) {
            $("#id_classificacao").prop("required", true);
            $("#id_id_responsavel").prop("required", true);
        } else {
            $("#id_classificacao").removeAttr("required");
            $("#id_id_responsavel").removeAttr("required");
        }
    });

var optionProcessoSAT = `
<option value="Análise">Análise</option>
<option value="Agendamento">Agendamento</option>
<option value="Atendimento">Atendimento</option>
<option value="Termo de Quitação">Termo de Quitação</option>
<option value="Jurídico">Jurídico</option>
<option value="Concluído">Concluído</option>
<option value="Fora de Garantia">Fora de Garantia</option>
<option value="Cancelado">Cancelado</option>
`;
var optionProcessoConservacao = `
<option value="">---------</option>
<option value="Agendamento">Agendamento</option>
<option value="Limpeza">Limpeza</option>
<option value="Manutenção">Manutenção</option>
<option value="Pagar">Pagar</option>
<option value="Concluído">Concluído</option>
<option value="Cancelado">Cancelado</option>
`;
var optionLocacao = `
<option value="0">Mãe</option>
<option value="1">Negociação</option>
<option value="2">Contrato</option>
<option value="3">Ligação de Energia</option>
<option value="4">Orçar</option>
<option value="5">Pagar</option>
<option value="6">Instalar</option>
<option value="7">Limpar</option>
<option value="8">Vistoria</option>
<option value="9">Entrega de Chaves</option>
<option value="11">Retorno de Locação</option>
`;
var optionAmbiente = `
<option value="">---------</option>
<option value="Apartamento">Apartamento</option>
<option value="Área Comum">Área Comum</option>
<option value="Área de Serviço">Área de Serviço</option>
<option value="Banheiro Social">Banheiro Social</option>
<option value="Banheiro Suíte">Banheiro Suíte</option>
<option value="Banheiro Suíte 1">Banheiro Suíte 1</option>
<option value="Banheiro Suíte 2">Banheiro Suíte 2</option>
<option value="Cozinha">Cozinha</option>
<option value="Dormitório 1">Dormitório 1</option>
<option value="Dormitório 2">Dormitório 2</option>
<option value="Dormitório 3">Dormitório 3</option>
<option value="Lavabo">Lavabo</option>
<option value="Outros">Outros</option>
<option value="Residência">Residência</option>
<option value="Sacada">Sacada</option>
<option value="Sala">Sala</option>
<option value="Suíte">Suíte</option>
<option value="Suíte 1">Suíte 1</option>
<option value="Suíte 2">Suíte 2</option>
<option value="Terreno">Terreno</option>
`;
var optionReparo = `
<option value="">---------</option>
<option value="Ar Condicionado">Ar Condicionado</option>
<option value="Especialista">Especialista</option>
<option value="Esquadrias de Alumínio">Esquadrias de Alumínio</option>
<option value="Esquadrias de Madeira">Esquadrias de Madeira</option>
<option value="Impermeabilização">Impermeabilização</option>
<option value="Instalações Elétricas">Instalações Elétricas</option>
<option value="Instalações Hidráulicas">Instalações Hidráulicas</option>
<option value="Instalações Gás">Instalações Gás</option>
<option value="Jardins">Jardins</option>
<option value="Limpeza">Limpeza</option>
<option value="Marcenaria">Marcenaria</option>
<option value="Lógica e Telefonia">Lógica e Telefonia</option>
<option value="Pedras">Pedras</option>
<option value="Pintura">Pintura</option>
<option value="Pisos">Pisos</option>
<option value="Revestimentos Cerâmicos">Revestimentos Cerâmicos</option>
<option value="Serviço Civil">Serviço Civil</option>
`;
var optionProcedencia = `
<option value="">---------</option>
<option value="Sim">Sim</option>
<option value="Sim com ressalva">Sim com ressalva</option>
<option value="Não">Não</option>
`;
var optionDuracao = `
<option value="">---------</option>
<option value="0.33">Baby</option>
<option value="1">PP</option>
<option value="3">P</option>
<option value="5">M</option>
<option value="8">G</option>
<option value="13">GG</option>
<option value="21">EG</option>
<option value="34">Gigante</option>
<option value="55">Gigante 1</option>
<option value="89">Gigante 2</option>
<option value="144">Gigante 3</option>
<option value="233">Gigante 4</option>
<option value="377">Gigante 5</option>
`;
var optionRaiz = `
<option value="">---------</option>
<option value="Material">Material</option>
<option value="Mão de obra">Mão de obra</option>
`;

    try{
        var status_solicitacao = $("#id_status_processo").val();
        if($("#id_processo_relacionado").val() == 75){
            $("#id_status_processo").html(optionProcessoSAT);
            $("#id_status_processo").val(status_solicitacao);
        } else if($("#id_processo_relacionado").val() == 51){
            $("#id_status_processo").html(optionProcessoConservacao);
            $("#id_status_processo").val(status_solicitacao);
        }
    }
    catch{
        console.log('sem sat')
    }
    
    $("#id_processo_relacionado").change(function(){
        if($("#id_processo_relacionado").val() == 75){
            $("#id_status_processo").html(optionProcessoSAT);
            $("#id_status_processo").val(status_solicitacao);
        } else if($("#id_processo_relacionado").val() == 51){
            $("#id_status_processo").html(optionProcessoConservacao);
            $("#id_status_processo").val(status_solicitacao);
            console.log('Trocou: C / L');
        } else{
        }
    });

    function ControlProblemas() {
        function calcularPeso(duracaoTotal) {
            if (duracaoTotal >= 0 && duracaoTotal <= 0.33) {
                $("#id_tempo_total").val(1)
            } else if (duracaoTotal > 0.33 && duracaoTotal <= 1) {
                $("#id_tempo_total").val(2)
            } else if (duracaoTotal > 1 && duracaoTotal <= 3) {
                $("#id_tempo_total").val(3)
            } else if (duracaoTotal > 3 && duracaoTotal <= 5) {
                $("#id_tempo_total").val(4)
            } else if (duracaoTotal > 5 && duracaoTotal <= 8) {
                $("#id_tempo_total").val(5)
            } else if (duracaoTotal > 8 && duracaoTotal <= 13) {
                $("#id_tempo_total").val(6)
            } else if (duracaoTotal > 13 && duracaoTotal <= 21) {
                $("#id_tempo_total").val(7)
            } else if (duracaoTotal > 21 && duracaoTotal <= 34) {
                $("#id_tempo_total").val(8)
            } else if (duracaoTotal > 34 && duracaoTotal <= 55) {
                $("#id_tempo_total").val(9)
            } else if (duracaoTotal > 55 && duracaoTotal <= 89) {
                $("#id_tempo_total").val(10)
            } else if (duracaoTotal > 89 && duracaoTotal <= 144) {
                $("#id_tempo_total").val(11)
            } else if (duracaoTotal > 144 && duracaoTotal <= 233) {
                $("#id_tempo_total").val(12)
            } else if (duracaoTotal > 233 && duracaoTotal <= 377) {
                $("#id_tempo_total").val(13)
            } else {
                $("#id_tempo_total").val(13)
            }
        }
        
        var id = $("#id_tarefa").val();
        url = "{% url 'Tarefa:getProblemas' %}"
        url_completa = url + id

        $.ajax({
            type: 'GET',
            url: url_completa,
            dataType: 'json',
            success: function (data) {
                var problemas = JSON.parse(data);
                if(problemas[0] != undefined){
                    if(problemas[0].fields.ambiente != null){
                        for (qtdProblema = 0; qtdProblema < problemas.length; qtdProblema++) {
                            $(".bloco_problema").prop('id', problemas.length)
                            if (((qtdProblema + 1) % 2) == 1) {
                                $("#problema1").html(
                                    $("#problema1").html() + `
                                    <div id="linha${(qtdProblema + 1)}" id="linha${(qtdProblema + 1)}" class="row linha impar">
                                        <div class="row">
                                            <input class="finalizado" type="checkbox" id="id_finalizado${(qtdProblema + 1)}" name="finalizado${(qtdProblema + 1)}">
                                            <label class="num_problema" id="id_num_problema${(qtdProblema + 1)}">${(qtdProblema + 1)}:</label>
                                        </div>
                                        <div class="ba1_min">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_ambiente">Ambiente:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" name="ambiente${(qtdProblema + 1)}" id="ambiente${(qtdProblema + 1)}" class="ambiente">${optionAmbiente}}</select>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <label for="id_procedencia1">Procedencia:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" name="procedencia${(qtdProblema + 1)}" id="procedencia${(qtdProblema + 1)}" class="procedencia">${optionProcedencia}</select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_descricao_problema1">Descrição problema:</label>
                                                    <div class="input-group bs-select">
                                                        <textarea name="descricao_sat${(qtdProblema + 1)}" rows="4" id="descricao${(qtdProblema + 1)}" class="descricao_problema">${problemas[qtdProblema].fields.descricao_sat}</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bb1_min">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_tipo_reparo1">Tipo reparo:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" name="tipo_reparo${(qtdProblema + 1)}" id="reparo${(qtdProblema + 1)}" class="reparo">${optionReparo}</select>
                                                    </div>
                                                </div>
        
                                                <div class="col">
                                                    <label for="id_raiz">Causa Raíz:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" class="procedencia" name="raiz${(qtdProblema + 1)}" id="raiz${(qtdProblema + 1)}" class="procedencia">${optionRaiz}</select>
                                                    </div>
                                                </div>
        
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_historico1">Historico:</label>
                                                    <div class="input-group bs-select">
                                                        <textarea name="historico_sat${(qtdProblema + 1)}" rows="4" id="historico${(qtdProblema + 1)}" class="historico_sat">${problemas[qtdProblema].fields.historico_sat}</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bc1_min">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_estimativa_custo1">Est. Custo:</label>
                                                    <div class="input-group bs-select">
                                                        <input type="text" name="estimativa_custo${(qtdProblema + 1)}" id="estimativa_custo${(qtdProblema + 1)}" value="${problemas[qtdProblema].fields.estimativa_custo}" class="estimativa_custo">
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <label for="id_duracao1">Duração:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" name="duracao${(qtdProblema + 1)}" id="duracao${(qtdProblema + 1)}" class="duracao">${optionDuracao}</select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_material1">Material:</label>
                                                    <div class="input-group bs-select">
                                                        <textarea name="material${(qtdProblema + 1)}" rows="4" id="material${(qtdProblema + 1)}" class="material">${problemas[qtdProblema].fields.material}</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            </div>
                                            <button type="button" class="remove-problema" id="remove-problema${(qtdProblema + 1)}" onclick="apagarSolicitacao${(qtdProblema + 1)}()">
                                                <i class="fa fa-trash" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                    `);
                            } else {
                                $("#problema1").html($("#problema1").html() + `
                                    <div id="linha${(qtdProblema + 1)}" id="linha${(qtdProblema + 1)}" class="row linha par">
                                        <div class="row">
                                            <input class="finalizado" type="checkbox" id="id_finalizado${(qtdProblema + 1)}" name="finalizado${(qtdProblema + 1)}">
                                            <label class="num_problema" id="id_num_problema${(qtdProblema + 1)}">${(qtdProblema + 1)}:</label>
                                        </div>
                                        <div class="ba1_min">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_ambiente">Ambiente:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" name="ambiente${(qtdProblema + 1)}" id="ambiente${(qtdProblema + 1)}" class="ambiente">${optionAmbiente}}</select>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <label for="id_procedencia1">Procedencia:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" name="procedencia${(qtdProblema + 1)}" id="procedencia${(qtdProblema + 1)}" class="procedencia">${optionProcedencia}</select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_descricao_problema1">Descrição problema:</label>
                                                    <div class="input-group bs-select">
                                                        <textarea name="descricao_sat${(qtdProblema + 1)}" rows="4" id="descricao${(qtdProblema + 1)}" class="descricao_problema">${problemas[qtdProblema].fields.descricao_sat}</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bb1_min">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_tipo_reparo1">Tipo reparo:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" name="tipo_reparo${(qtdProblema + 1)}" id="reparo${(qtdProblema + 1)}" class="reparo">${optionReparo}</select>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <label for="id_raiz">Causa Raíz:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" class="procedencia" name="raiz${(qtdProblema + 1)}" id="raiz${(qtdProblema + 1)}" class="procedencia">${optionRaiz}</select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_historico1">Historico:</label>
                                                    <div class="input-group bs-select">
                                                        <textarea name="historico_sat${(qtdProblema + 1)}" rows="4" id="historico${(qtdProblema + 1)}" class="historico_sat">${problemas[qtdProblema].fields.historico_sat}</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bc1_min">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_estimativa_custo1">Est. Custo:</label>
                                                    <div class="input-group bs-select">
                                                        <input type="text" name="estimativa_custo${(qtdProblema + 1)}" id="estimativa_custo${(qtdProblema + 1)}" value="${problemas[qtdProblema].fields.estimativa_custo}" class="estimativa_custo">
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <label for="id_duracao1">Duração:</label>
                                                    <div class="input-group bs-select">
                                                        <select type="text" name="duracao${(qtdProblema + 1)}" id="duracao${(qtdProblema + 1)}" class="duracao">${optionDuracao}</select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <label for="id_material1">Material:</label>
                                                    <div class="input-group bs-select">
                                                        <textarea name="material${(qtdProblema + 1)}" rows="4" id="material${(qtdProblema + 1)}" class="material">${problemas[qtdProblema].fields.material}</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            </div>
                                            <button type="button" class="remove-problema" id="remove-problema${(qtdProblema + 1)}" onclick="apagarSolicitacao${(qtdProblema + 1)}()">
                                                <i class="fa fa-trash" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                `);
                            }
                            $("[name=qtdProblema]").val(qtdProblema + 1)
                        }
                        let duracaoTotal = 0;
                        for (qtdProblema = 0; qtdProblema < problemas.length; qtdProblema++) {
                            $("#ambiente" + (qtdProblema + 1)).val(problemas[qtdProblema].fields.ambiente)
                            $("#procedencia" + (qtdProblema + 1)).val(problemas[qtdProblema].fields.procedencia)
                            $("#reparo" + (qtdProblema + 1)).val(problemas[qtdProblema].fields.tipo_reparo)
                            $("#duracao" + (qtdProblema + 1)).val(problemas[qtdProblema].fields.duracao)
                            duracaoTotal += parseFloat($("#duracao" + (qtdProblema + 1)).val());
                            problemas[qtdProblema].fields.finalizado == 1 ? $(`#id_finalizado${(qtdProblema + 1)}`).attr("checked", "checked") : $(`#id_finalizado${(qtdProblema + 1)}`).removeAttr("checked", "checked")
                        }
                        $("#pesoTotal").val();
                        calcularPeso(duracaoTotal);
                    }
                }
            },
            error: function () {
                console.log("Erro")
            }
        });        
    }
    ControlProblemas();
    var qtdProblema = $(".bloco_problema").attr("id");
    $("#add-problema").click(function () {
        if (qtdProblema >= 20) {
            alert("Limite de problemas atingido")
        } else {
            if (((qtdProblema + 1) % 2) == 1) {
                $("#problema" + (qtdProblema + 1))
                    .html(`
                    <div id="linha${(qtdProblema + 1)}" class="row linha impar">
                        <div class="row">
                            <input class="finalizado" type="checkbox" id="id_finalizado${(qtdProblema + 1)}" name="finalizado${(qtdProblema + 1)}">
                            <label class="num_problema" id="id_num_problema${(qtdProblema + 1)}">${(qtdProblema + 1)}:</label>
                        </div>
                        <div class="ba1_min">
                            <div class="row">
                                <div class="col-6">
                                    <label for="id_ambiente">Ambiente:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="ambiente" name="ambiente${(qtdProblema + 1)}"" id="ambiente${(qtdProblema + 1)}" class="ambiente">${optionAmbiente}</select>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <label for="id_procedencia1">Procedencia:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="procedencia" name="procedencia${(qtdProblema + 1)}" id="procedencia${(qtdProblema + 1)}" class="procedencia">${optionProcedencia}</select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label for="id_descricao_problema1">Descrição problema:</label>
                                    <div class="input-group bs-select">
                                        <textarea name="descricao_sat${(qtdProblema + 1)}" rows="4" id="descricao${(qtdProblema + 1)}" class="descricao_problema"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bb1_min">
                            <div class="row">
                                <div class="col">
                                    <label for="id_tipo_reparo1">Tipo reparo:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="tipo_reparo" name="tipo_reparo${(qtdProblema + 1)}" id="reparo${(qtdProblema + 1)}" class="reparo">${optionReparo}</select>
                                    </div>
                                </div>
                                <div class="col">
                                    <label for="id_raiz">Causa Raíz:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="procedencia" name="raiz${(qtdProblema + 1)}" id="raiz${(qtdProblema + 1)}" class="procedencia">${optionRaiz}</select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label for="id_historico1">Historico:</label>
                                        <div class="input-group bs-select">
                                            <textarea name="historico_sat${(qtdProblema + 1)}" rows="4" id="historico${(qtdProblema + 1)}" class="historico_sat"></textarea>
                                        </div>
                                </div>
                            </div>
                        </div>
                        <div class="bc1_min">
                            <div class="row">
                                <div class="col">
                                    <label for="id_estimativa_custo1">Est. Custo:</label>
                                    <div class="input-group bs-select">
                                        <input type="text" class="estimativa_custo" name="estimativa_custo${(qtdProblema + 1)}" id="estimativa_custo${(qtdProblema + 1)}" class="estimativa_custo" value="">
                                    </div>
                                </div>
                                <div class="col">
                                    <label for="id_duracao1">Duração:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="duracao" name="duracao${(qtdProblema + 1)}" id="duracao${(qtdProblema + 1)}" class="duracao">${optionDuracao}</select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label for="id_material1">Material:</label>
                                    <div class="input-group bs-select">
                                        <textarea name="material${(qtdProblema + 1)}" rows="4" id="material${(qtdProblema + 1)}" class="material"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="remove-problema" id="remove-problema${(qtdProblema + 1)}" onclick="apagarSolicitacao${(qtdProblema + 1)}()" >
                            <i class="fa fa-trash" aria-hidden="true"></i>
                        </button>
                    </div>`)
                    .css("display", "inline");
                $("#qtdProblemas").html(`<input type="text" name="qtdProblemas" value="${(qtdProblema + 1)}">`)
                qtdProblema += 1;
            } else {
                $("#problema" + (qtdProblema + 1))
                    .html(`
                    <div id="linha${(qtdProblema + 1)}" class="row linha par">
                        <div class="row">
                            <input class="finalizado" type="checkbox" id="id_finalizado${(qtdProblema + 1)}" name="finalizado${(qtdProblema + 1)}">
                            <label class="num_problema" id="id_num_problema${(qtdProblema + 1)}">${(qtdProblema + 1)}:</label>
                        </div>
                        <div class="ba1_min">
                            <div class="row">
                                <div class="col-6">
                                    <label for="id_ambiente">Ambiente:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="ambiente" name="ambiente${(qtdProblema + 1)}"" id="ambiente${(qtdProblema + 1)}" class="ambiente">${optionAmbiente}</select>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <label for="id_procedencia1">Procedencia:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="procedencia" name="procedencia${(qtdProblema + 1)}" id="procedencia${(qtdProblema + 1)}" class="procedencia">${optionProcedencia}</select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label for="id_descricao_problema1">Descrição problema:</label>
                                    <div class="input-group bs-select">
                                        <textarea name="descricao_sat${(qtdProblema + 1)}" rows="4" id="descricao${(qtdProblema + 1)}" class="descricao_problema"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bb1_min">
                            <div class="row">
                                <div class="col">
                                    <label for="id_tipo_reparo1">Tipo reparo:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="tipo_reparo" name="tipo_reparo${(qtdProblema + 1)}" id="reparo${(qtdProblema + 1)}" class="reparo">${optionReparo}</select>
                                    </div>
                                </div>
                                <div class="col">
                                    <label for="id_raiz">Causa Raíz:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="procedencia" name="raiz${(qtdProblema + 1)}" id="raiz${(qtdProblema + 1)}" class="procedencia">${optionRaiz}</select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label for="id_historico1">Historico:</label>
                                        <div class="input-group bs-select">
                                            <textarea name="historico_sat${(qtdProblema + 1)}" rows="4" id="historico${(qtdProblema + 1)}" class="historico_sat"></textarea>
                                        </div>
                                </div>
                            </div>
                        </div>
                        <div class="bc1_min">
                            <div class="row">
                                <div class="col">
                                    <label for="id_estimativa_custo1">Est. Custo:</label>
                                    <div class="input-group bs-select">
                                        <input type="text" class="estimativa_custo" name="estimativa_custo${(qtdProblema + 1)}" id="estimativa_custo${(qtdProblema + 1)}" class="estimativa_custo" value="">
                                    </div>
                                </div>
                                <div class="col">
                                    <label for="id_duracao1">Duração:</label>
                                    <div class="input-group bs-select">
                                        <select type="text" class="duracao" name="duracao${(qtdProblema + 1)}" id="duracao${(qtdProblema + 1)}" class="duracao">${optionDuracao}</select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label for="id_material1">Material:</label>
                                    <div class="input-group bs-select">
                                        <textarea name="material${(qtdProblema + 1)}" rows="4" id="material${(qtdProblema + 1)}" class="material"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="remove-problema" id="remove-problema${(qtdProblema + 1)}" onclick="apagarSolicitacao${(qtdProblema + 1)}()" >
                            <i class="fa fa-trash" aria-hidden="true"></i>
                        </button>
                    </div>`)
                    .css("display", "inline");
                $("#qtdProblemas").html(`<input type="text" name="qtdProblemas" value="${(qtdProblema + 1)}">`)
                qtdProblema += 1;
            }
        }
    });

    function acessarProblemas(botao) {
        try{
            var id = $("#id_tarefa").val();
            url = "{% url 'Tarefa:getProblemas' %}"
            url_completa = url + id
            $.ajax({
            type: 'GET',
            url: url_completa,
            dataType: 'json',
            success: function (data) {
                var problemas = JSON.parse(data);
                for (i = botao; i < qtdProblema; i++) {
                    $("#ambiente" + i).val($("#ambiente" + (i + 1)).val())
                    $("#descricao" + i).val($("#descricao" + (i + 1)).val())
                    $("#reparo" + i).val($("#reparo" + (i + 1)).val())
                    $("#procedencia" + i).val($("#procedencia" + (i + 1)).val())
                    $("#historico" + i).val($("#historico" + (i + 1)).val())
                    $("#estimativa_custo" + i).val($("#estimativa_custo" + (i + 1)).val())
                    $("#duracao" + i).val($("#duracao" + (i + 1)).val())
                    $("#material" + i).val($("#material" + (i + 1)).val())
                    botao += 1
                }
                if (i == 1) {
                    $("#ambiente" + i).val("")
                    $("#descricao" + i).val("")
                    $("#reparo" + i).val("")
                    $("#procedencia" + i).val("")
                    $("#historico" + i).val("")
                    $("#estimativa_custo" + i).val("")
                    $("#duracao" + i).val("")
                    $("#material" + i).val("")
                } else {
                    $("#linha" + i).remove()
                    qtdProblema -= 1
                }
            },
            error: function () {
                console.log("Erro")
            }
        });
        } catch{
            null
        }
        
    }

    function apagarSolicitacao1() {
        acessarProblemas(1)
    }
    function apagarSolicitacao2() {
        acessarProblemas(2)
    }
    function apagarSolicitacao3() {
        acessarProblemas(3)
    }
    function apagarSolicitacao4() {
        acessarProblemas(4)
    }
    function apagarSolicitacao5() {
        acessarProblemas(5)
    }
    function apagarSolicitacao6() {
        acessarProblemas(6)
    }
    function apagarSolicitacao7() {
        acessarProblemas(7)
    }
    function apagarSolicitacao8() {
        acessarProblemas(8)
    }
    function apagarSolicitacao9() {
        acessarProblemas(9)
    }
    function apagarSolicitacao10() {
        acessarProblemas(10)
    }
    function apagarSolicitacao11() {
        acessarProblemas(11)
    }
    function apagarSolicitacao12() {
        acessarProblemas(12)
    }
    function apagarSolicitacao13() {
        acessarProblemas(13)
    }
    function apagarSolicitacao14() {
        acessarProblemas(14)
    }
    function apagarSolicitacao15() {
        acessarProblemas(15)
    }
    function apagarSolicitacao16() {
        acessarProblemas(16)
    }
    function apagarSolicitacao17() {
        acessarProblemas(17)
    }
    function apagarSolicitacao18() {
        acessarProblemas(18)
    }
    function apagarSolicitacao19() {
        acessarProblemas(19)
    }
    function apagarSolicitacao20() {
        acessarProblemas(20)
    }

    // Atualiza campos de nome do proprietário ao editar um deles
    $("#id_proprietario_nome1").val($("#id_proprietario_nome").val());
    $("#id_proprietario_nome1").keyup(function () {
        $("#id_proprietario_nome").val($("#id_proprietario_nome1").val());
    });
    $("#id_proprietario_nome").keyup(function () {
        $("#id_proprietario_nome1").val($("#id_proprietario_nome").val());
    });

    // Atualiza campos de Porcentagem SAT e Porcentagem ao editar um deles
    $("#id_porcentagem_sat").val($("#id_porcentagem").val());
    $("#id_porcentagem_sat").keyup(function () {
        $("#id_porcentagem").val($("#id_porcentagem_sat").val());
    });
    $("#id_porcentagem").keyup(function () {
        $("#id_porcentagem_sat").val($("#id_porcentagem").val());
    });

    // Atualiza campos de Status Solicitação e Status Pendência ao editar um deles
    $("#id_sDescri").val($("#id_status_pendencia").val());
    $("#id_sDescri").change(function () {
        $("#id_status_pendencia").val($("#id_sDescri").val());
    });
    $("#id_status_pendencia").change(function () {
        $("#id_sDescri").val($("#id_status_pendencia").val());
    });

    // Atualiza campos de Data Inicial e Data Abertura ao editar um deles
    $("#id_data_abertura").val($("#id_data_ini").val());
    $("#id_data_abertura").change(function () {
        $("#id_data_ini").val($("#id_data_abertura").val());
    });
    $("#id_data_ini").change(function () {
        $("#id_data_abertura").val($("#id_data_ini").val());
    });

    // Atualiza campos de Data Real e Data Atendimento ao editar um deles
    $("#id_data_atendimento").val($("#id_data_real").val());
    $("#id_data_atendimento").change(function () {
        $("#id_data_real").val($("#id_data_atendimento").val());
    });
    $("#id_data_real").change(function () {
        $("#id_data_atendimento").val($("#id_data_real").val());
    });

    // Puxa data final da Tarefa se data final da Solicitação estiver vazia
    if ($("#id_data_finalizacao_sat").val() == "") {
        $("#id_data_finalizacao_sat").val($("#id_data_fim").val());
    }

    // Atualiza o campo de Tempo Total ao editar uma duração
    var atualizarTempo = 0;
    $("#duracao1").focus(function () {
        // atualizarTempo = $("#duracao1").val();
        // $("#duracao1").change(function(){
        //     console.log("Teste")
        //     $("#tempo_total").val(1);
        // });
    });

    try{
        $("#id_status_locacao1").html(optionLocacao);
        $("#id_status_locacao1").val($("#id_status_locacao").text());
    } catch{
        null;
    }
    
    var tarefas = document.querySelectorAll("#historicoJuridico span");
    let statusHistorico = '', pendenciaHistorico = '', historicoHistorico = '', aux1 = '', aux2 = '', htmlHistorico = '';
    for(let i = tarefas.length - 1; i >= 0 ; i--){
        aux1 = tarefas[i].innerText.split(' i/i ');
        statusHistorico = aux1[0]
        switch(statusHistorico){
            case '1':
                statusHistorico = 'Tarefa Mãe';
                break;
            case '2':
                statusHistorico = 'Petição Inicial';
                break;
            case '3':
                statusHistorico = 'Defesa';
                break;
            case '4':
                statusHistorico = 'Réplica';
                break;
            case '5':
                statusHistorico = 'Audiência';
                break;
            case '6':
                statusHistorico = 'Alegações Finais';
                break;
            case '7':
                statusHistorico = 'Sentença';
                break;
            case '8':
                statusHistorico = 'Recurso: 2ª Instância';
                break;
            case '9':
                statusHistorico = 'Recurso: 3ª Instância';
                break;
        }
        aux2 = aux1[1].split(' h/h ')
        pendenciaHistorico = aux2[0]
        historicoHistorico = aux2[1]
        htmlHistorico += `
            <!-- ${statusHistorico} -->
            <div class="row d-flex flex-column">
                <label for="id_bloco">${statusHistorico}:</label>
                <textarea rows="4">${pendenciaHistorico}\n${historicoHistorico}</textarea>
            </div>
            `
        $("#historicoJuridico").html(htmlHistorico)
    }
    
    let optionJuridico = `
    <option value="1">Mãe</option>
    <option value="2">Petição Inicial</option>
    <option value="3">Defesa</option>
    <option value="4">Réplica</option>
    <option value="5">Audiência</option>
    <option value="6">Alegações Finais</option>
    <option value="7">Sentença</option>
    <option value="8">Recurso: 2ª Instância</option>
    <option value="9">Recurso: 3ª Instância</option>
    `
    try{
        $("#id_status_juridico1").html(optionJuridico);
        $("#id_status_juridico1").val($("#id_status_juridico").text());
        $("#id_status_juridico1").addClass('form-control form-control-sm')
    } catch{
        null
    }

    var tarefa_id;
$("#loader").show();
$(function(){

  //Buscando cards do kanban
  var teste = $('.tarefa');

  //Reconhecendo e formatando data atual
  let data = new Date();
  let dia = data.getDate();
  let mes = data.getMonth();
  let ano = data.getFullYear();

  //Adicionar 0 para dias/meses 1 e 9
  function formatarData(data){
    let dataFormatada
    if(data >= 0 && data <= 9){
      dataFormatada = data.toString();
      dataFormatada = '0' + dataFormatada;
    } else{
      dataFormatada = data.toString();
    }
    return dataFormatada;
  }

  //Guardando data atual formatada em variável
  let dataAtual = new Date(formatarData(ano) + '-' + formatarData(mes + 1) + '-' + formatarData(dia));

  //Criando variáveis para armazenamento de quantidade de tarefas (A Fazer(Atrasada e Aviso), Fazendo(Adiantada, Atrasada e Aviso) e Feito(Finalizada))
  let aFazerAtrasada = 0;
  let aFazerAviso = 0;
  let fazendoAdiantada = 0;
  let fazendoAtrasada = 0;
  let fazendoAviso = 0;
  let feitoFinalizada = 0;

  //Percorrendo cada tarefa criada no kanban
  //indice = id / valor = conteúdo
  $.each(teste, function(indice, valor){
    //Buscando dados no código
    let dataInicial = $('#dataInicial' + $(valor).attr('id')).text();
    let dataFinal = $('#dataFinal' + $(valor).attr('id')).text();
    let status = $('#status' + $(valor).attr('id')).text();
    let statusPrazo = $('#statusPrazo' + $(valor).attr('id')).text();

    //Formatando data para jQuery
    let formatarInicial = dataInicial.split('/');
    let formatarFinal= dataFinal.split('/');

    //Colocando data formatada no Date()
    let inicial = new Date(formatarInicial[2] + '-' + formatarInicial[1] + '-' + formatarInicial[0]);
    let final = new Date(formatarFinal[2] + '-' + formatarFinal[1] + '-' + formatarFinal[0]);

    let id = $(valor).attr('id');
    let prazo = $('#prazo' + $(valor).attr('id')).text();
    let porcentagem = $("#porcentagem" + $(valor).attr('id')).val();

    let realizado = porcentagem;
    let previsto

    let diaUtil = 0
    for (i = inicial.getTime(); i <= final.getTime() ; i += 86400000){
      i += 86400000;
      diaSemana = new Date(i);
      if ( (diaSemana.getDay() > 0) && (diaSemana.getDay() < 6) ) {
        diaUtil += 1;
      }
      i -= 86400000;
    }
    previsto = (100 * (dataAtual.getTime() - (inicial.getTime()) + 86400000) / 86400000) / diaUtil;
    let previstoDiario = 100 / diaUtil;
    let diasAdiantado = (realizado - previsto) / previstoDiario;

    if (inicial.getTime() > dataAtual.getTime()){
      previsto = 0;
    } else if (final.getTime() - dataAtual.getTime() == 0 || final.getTime() < dataAtual.getTime()){
      previsto = 100;
    }

    // Verificando se tarefa é mãe/filho
    if($("#is_locacao" + $(valor).attr('id')).html() == 0){
      $("#is_locacao" + $(valor).attr('id')).attr('title', 'Tarefa Mãe').html(`<i class="fas fa-female" style="color: pink;"></i>`).show()
    } else if ($("#is_locacao" + $(valor).attr('id')).html() > 0){
      $("#is_locacao" + $(valor).attr('id')).attr('title', 'Tarefa Filho').html(`<i class="fas fa-baby" style="color: #cecece;"></i>`).show()
    }

    //Verificando status das tarefas e adicionando cores de fundo
    if (status == 'Feito'){ //Feito
      //Adicionando fundo cinza para tarefas finalizadas
      $(valor).toggleClass('finalizada');

      //Incrementando variável com quantidade de tarefas
      feitoFinalizada += 1;

      //Calculando status do prazo / finalizada hoje ou x dias
      if (dataAtual.getTime() == final.getTime()){
        $('#statusPrazo' + $(valor).attr('id')).html('<span title="Finalizada:" aria-label="100%"> <div style="display: none;"> <span id="finalizada' + $(valor).attr('id') + '">0</span> </div> Hoje </span>');
      } else if ((dataAtual.getTime() - final.getTime()) / 86400000 == 1) {
        $('#statusPrazo' + $(valor).attr('id')).html('<span title="Finalizada há:" aria-label="100%"> <span id="finalizada' + $(valor).attr('id') + '">1</span> dia</span>');
      } else{
        $('#statusPrazo' + $(valor).attr('id')).html('<span title="Finalizada há:" aria-label="100%"><span id="finalizada' + $(valor).attr('id') + '">' + (dataAtual.getTime() - final.getTime()) / 86400000 + '</span> dias </span>');
      }

    } else if (status == 'A fazer'){ //A fazer

      if (inicial.getTime() >= dataAtual.getTime()){
        //Adicionando fundo amarelo para tarefas
        $(valor).toggleClass('aviso');

        //Incrementando variável com quantidade de tarefas
        aFazerAviso += 1;
        //Adicionando cor amarela ao status do prazo
        $('#statusPrazo' + $(valor).attr('id')).toggleClass('text-warning')
        //Calculando status do prazo / inicia hoje ou x dias
        if (inicial.getTime() == dataAtual.getTime()){
          $('#statusPrazo' + $(valor).attr('id')).html('<span title="Inicia:" aria-label="100%"> <div style="display: none;"> <span id="atencao' + $(valor).attr('id') + '">0</span> </div> Hoje </span>');
        } else {
          if ((inicial.getTime() - dataAtual.getTime()) / 86400000 == 1){
            $('#statusPrazo' + $(valor).attr('id')).html('<span title="Inicia em:" aria-label="100%"> <span id="atencao' + $(valor).attr('id') + '">1</div> dia</span>');
          } else {
            $('#statusPrazo' + $(valor).attr('id')).html('<span title="Inicia em:" aria-label="100%"><span id="atencao' + $(valor).attr('id') + '">' + (inicial.getTime() - dataAtual.getTime()) / 86400000 + '</span> dias</span>');
          }
        }
      } else {
        //Adicionando fundo vermelho para tarefas
        $(valor).toggleClass('atrasada');

        //Incrementando variável com quantidade de tarefas
        aFazerAtrasada += 1;

        $('#statusPrazo' + $(valor).attr('id')).toggleClass('text-danger')
        realizado = 0;

        $('#statusPrazo' + $(valor).attr('id')).html('<span title="Atrasada em:" aria-label="100%"> ↓ <span id="atrasada' + $(valor).attr('id') + '">' + (previsto - realizado).toFixed(2) + '</span> % - <span>' + ((dataAtual.getTime() - inicial.getTime()) / 86400000 + 1) + '</span> dias</span>');


      }
    } else { //Fazendo
      if (realizado > previsto){
        //Adicionando fundo verde para tarefas
        $(valor).toggleClass('adiantada');

        //Incrementando variável com quantidade de tarefas
        fazendoAdiantada += 1;

        //Adicionando cor verde ao status do prazo
        $('#statusPrazo' + $(valor).attr('id')).toggleClass('text-success')

        //Adicionando fundo verde para barra de progresso
        $('.progress-bar' + $(valor).attr('id')).css('background', '#03F40F')

        //Calculando status do prazo
        if (diasAdiantado >= 0 && diasAdiantado < 2){
          $('#statusPrazo' + $(valor).attr('id')).html('<span title="Adiantada em:" aria-label="100%"> ↑ <span id="adiantada' + $(valor).attr('id') + '">' + (realizado - previsto).toFixed(2) + '</span> % - <span>' + diasAdiantado.toFixed(2) + '</span> dia</span>');
        } else {
          $('#statusPrazo' + $(valor).attr('id')).html('<span title="Adiantada em:" aria-label="100%"> ↑ <span id="adiantada' + $(valor).attr('id') + '">' + (realizado - previsto).toFixed(2) + '</span> % - <span>' + diasAdiantado.toFixed(2) + '</span> dias</span>');
        }
      } else if ((inicial.getTime() + (prazo * 86400000)) >= dataAtual.getTime()) {
        //Adicionando fundo amarelo para tarefas
        $(valor).toggleClass('aviso');

        //Incrementando variável com quantidade de tarefas
        fazendoAviso += 1;

        //Adicionando fundo amarelo para barra de progresso
        $('.progress-bar' + $(valor).attr('id')).css('background', 'yellow')

        //Adicionando cor amarela ao status do prazo
        $('#statusPrazo' + $(valor).attr('id')).toggleClass('text-warning')

        //Calculando status do prazo / inicia hoje ou x dias
        if (inicial.getTime() == dataAtual.getTime()){
          $('#statusPrazo' + $(valor).attr('id')).html('<span title="Iniciada:" aria-label="100%"> <div style="display: none;"> <span id="atencao' + $(valor).attr('id') + '">0</span> </div>Hoje </span>');
        } else {
          if ((inicial.getTime() - dataAtual.getTime()) / 86400000 == -1){
            $('#statusPrazo' + $(valor).attr('id')).html('<span title="Iniciada há:" aria-label="100%"> <span id="atencao' + $(valor).attr('id') + '">1</span> dia</span>');
          } else {
            $('#statusPrazo' + $(valor).attr('id')).html('<span title="Iniciada há:" aria-label="100%"><span id="atencao' + $(valor).attr('id') + '">' + (dataAtual.getTime() - inicial.getTime()) / 86400000 + '</span> dias</span>');
          }
        }
      } else {
        //Adicionando fundo vermelho para tarefas
        $(valor).toggleClass('atrasada');

        //Incrementando variável com quantidade de tarefas
        fazendoAtrasada += 1;

        //Adicionando fundo vermelho para barra de progresso
        $('.progress-bar' + $(valor).attr('id')).css('background', 'red')

        //Adicionando cor vermelha ao status do prazo
        $('#statusPrazo' + $(valor).attr('id')).toggleClass('text-danger')

        //Calculando status do prazo
        if ((final.getTime() - dataAtual.getTime()) / 86400000 == -1){
          $('#statusPrazo' + $(valor).attr('id')).html('<span title="Atrasada em:" aria-label="100%"> ↓ <span id="atrasada' + $(valor).attr('id') + '">' + (previsto - realizado).toFixed(2) + '</span> % - <span>1</span> dia</span>');
        } else {
          $('#statusPrazo' + $(valor).attr('id')).html('<span title="Atrasada em:" aria-label="100%"> ↓ <span id="atrasada' + $(valor).attr('id') + '">' + (previsto - realizado).toFixed(2) + '</span> % - <span>' + (dataAtual.getTime() - final.getTime()) / 86400000 + '</span> dias</span>');
        }
      }
    }

    //Adicionando executores
    //Separa executores da tarefa
    let executor = $("#executores" + $(valor).attr('id')).html().split(",");
    //Verifica se há 1 ou 2 executores na tarefa

    for (let i = 0; i < executor.length; i++){
       if (i <= 1){
         $("#imagensExecutores" + $(valor).attr('id')).html($("#imagensExecutores" + $(valor).attr('id')).html() + " " + '<span class="col-xs p-icone executor mr-1" style="margin-top: 0;" title="Executor: ' + executor[i] +'"><img id="imgExecutor' + $(valor).attr('id') + i + '" class="rounded-circle" style="width: 100%; height: 100%"></span>');
         $("#imgExecutor" + $(valor).attr('id') + i).attr("src", "../../media/usuarios/" + executor[i] + "/perfil/" + executor[i] + ".png").on("error", function(){
           $("#imgExecutor" + $(valor).attr('id') + i).attr("src", "../../media/usuarios/Padrão/perfil/Padrão.png");
         });
       }
     }

    if (executor.length > 2){
       if ((parseInt(executor.length) - 2) == 1){
         $("#imagensExecutores" + $(valor).attr('id')).html($("#imagensExecutores" + $(valor).attr('id')).html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + '" style="font-size: 12px;">+' + (parseInt(executor.length) - 2) + '</span>');
       } else if ((parseInt(executor.length) - 2) == 2) {
         $("#imagensExecutores" + $(valor).attr('id')).html($("#imagensExecutores" + $(valor).attr('id')).html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + '" style="font-size: 12px;">+' + (parseInt(executor.length) - 2) + '</span>');
       } else if ((parseInt(executor.length) - 2) == 3) {
         $("#imagensExecutores" + $(valor).attr('id')).html($("#imagensExecutores" + $(valor).attr('id')).html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + '" style="font-size: 12px;">+' + (parseInt(executor.length) - 2) + '</span>');
       } else if ((parseInt(executor.length) - 2) == 4) {
         $("#imagensExecutores" + $(valor).attr('id')).html($("#imagensExecutores" + $(valor).attr('id')).html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\n" + '" style="font-size: 12px;">+' + (parseInt(executor.length) - 2) + '</span>');
       } else if ((parseInt(executor.length) - 2) == 5) {
         $("#imagensExecutores" + $(valor).attr('id')).html($("#imagensExecutores" + $(valor).attr('id')).html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\nExecutor: " + executor[6] + "\n" + '" style="font-size: 12px;">+' + (parseInt(executor.length) - 2) + '</span>');
       } else if ((parseInt(executor.length) - 2) == 6) {
         $("#imagensExecutores" + $(valor).attr('id')).html($("#imagensExecutores" + $(valor).attr('id')).html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\nExecutor: " + executor[6] + "\nExecutor: " + executor[7] + "\n" + '" style="font-size: 12px;">+' + (parseInt(executor.length) - 2) + '</span>');
       } else if ((parseInt(executor.length) - 2) == 7) {
         $("#imagensExecutores" + $(valor).attr('id')).html($("#imagensExecutores" + $(valor).attr('id')).html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\nExecutor: " + executor[6] + "\nExecutor: " + executor[7] + "\nExecutor: " + executor[8] + "\n" + '" style="font-size: 12px;">+' + (parseInt(executor.length) - 2) + '</span>');
       } else if ((parseInt(executor.length) - 2) == 8) {
         $("#imagensExecutores" + $(valor).attr('id')).html($("#imagensExecutores" + $(valor).attr('id')).html() + " " + '<span class="col-xs align-self-center maisExecutores" title="Executor: ' + executor[2] + "\nExecutor: " + executor[3] + "\nExecutor: " + executor[4] + "\nExecutor: " + executor[5] + "\nExecutor: " + executor[6] + "\nExecutor: " + executor[7] + "\nExecutor: " + executor[8] + "\nExecutor: " + executor[9] + '" style="font-size: 12px;">+' + (parseInt(executor.length) - 2) + '</span>');
       } else {
       $("#imagensExecutores" + $(valor).attr('id')).html("Executores inválidos");
     }
     }

    // Adicionando peso ao tamanho
    let tamanho = $("#peso" + $(valor).attr('id')).text();
    let value = '', peso = '';
    if (tamanho == "Baby"){
      peso = "0.33"
      value = 1
    } else if (tamanho == "PP"){
      peso = "1"
      value = 2
    } else if (tamanho == "P"){
      peso = "3"
      value = 3
    } else if (tamanho == "M"){
      peso = "5"
      value = 4
    } else if (tamanho == "G"){
      peso = "8"
      value = 5
    } else if (tamanho == "GG"){
      peso = "13"
      value = 6
    } else if (tamanho == "EG"){
      peso = "21"
      value = 7
    } else if (tamanho == "Gigante"){
      peso = "34"
      value = 8
    } else if (tamanho == "Gigante 1"){
      peso = "55"
      value = 9
    } else if (tamanho == "Gigante 2"){
      peso = "89"
      value = 10
    } else if (tamanho == "Gigante 3"){
      peso = "144"
      value = 11
    } else if (tamanho == "Gigante 4"){
      peso = "233"
      value = 12
    } else {
      peso = "377"
      value = 13
    }
    $("#peso" + $(valor).attr('id')).text(tamanho + ' - ' + peso)

    $("[name=stat" + $(valor).attr('id') + "]").val(status);
    $('[name=data_ini' + $(valor).attr('id') + "]").datepicker({todayBtn: "linked", language: "pt-BR", daysOfWeekDisabled: "0,6", daysOfWeekHighlighted: "1,2,3,4,5", autoclose: true, todayHighlight: true});
    $('[name=data_fim' + $(valor).attr('id') + "]").datepicker({todayBtn: "linked", language: "pt-BR", daysOfWeekDisabled: "0,6", daysOfWeekHighlighted: "1,2,3,4,5", autoclose: true, todayHighlight: true });
    $("[name=tamanho" + $(valor).attr('id') + "]").val(value);

    //Adicionando imagem de Responsável e autoridade
    let pessoaResponsavel = $("#responsavel" + $(valor).attr('id')).attr('title');
    $("#imgResponsavel" + $(valor).attr('id')).attr("src", "../../media/usuarios/" + pessoaResponsavel + "/perfil/" + pessoaResponsavel + ".png").on("error", function(){
      $("#imgResponsavel" + $(valor).attr('id')).attr("src", "../../media/usuarios/Padrão/perfil/Padrão.png");
    });
    $("#responsavel" + $(valor).attr('id')).prop('title', 'Responsável: ' + pessoaResponsavel);
    let pessoaAutoridade = $("#autoridade"  + $(valor).attr('id')).attr('title');
    $("#imgAutoridade" + $(valor).attr('id')).attr("src", "../../media/usuarios/" + pessoaAutoridade + "/perfil/" + pessoaAutoridade + ".png").on("error", function(){
      $("#imgAutoridade" + $(valor).attr('id')).attr("src", "../../media/usuarios/Padrão/perfil/Padrão.png");
    });
    $("#autoridade" + $(valor).attr('id')).prop('title', 'Autoridade: ' + pessoaAutoridade);

    //Removendo circulo/imagem de pendencia se não houver
    let pessoaImpedimento = $("#impedimento" + $(valor).attr('id')).attr('title');
    $("#impedimento" + $(valor).attr('id')).prop('title', 'Impedimento: ' + pessoaImpedimento);
    if (pessoaImpedimento == '' || pessoaImpedimento == 'None'){
      $("#impedimento" + $(valor).attr('id')).hide();
    } else {
        $("#imgImpedimento" + $(valor).attr('id')).attr("src", "../../media/usuarios/" + pessoaImpedimento + "/perfil/" + pessoaImpedimento + ".png").on("error", function(){
          $("#imgImpedimento" + $(valor).attr('id')).attr("src", "../../media/usuarios/Padrão/perfil/Padrão.png");
        });
    }

    //Removendo ícone de anexo se não houver
    let anexo1 = $("#anexo1" + $(valor).attr('id')).text();
    if (anexo1 == '' || anexo1 == 'None'){
      $("#anexo" + $(valor).attr('id')).hide();
    }

    //Removendo ícone de Retrospectiva se não houver
    let retrospectiva1 = $("#retrospectiva1" + $(valor).attr('id')).text();
    if (retrospectiva1 == '' || retrospectiva1 == 'None' || retrospectiva1 == '0'){
      $("#retrospectiva" + $(valor).attr('id')).hide();
    }

    //Removendo ícone de 5w2h se não houver
    let r5w2h1 = $("#r5w2h1" + $(valor).attr('id')).text();
    if (r5w2h1 == 'None' || r5w2h1 == '0'){
      $("#r5w2h" + $(valor).attr('id')).hide();
    }

    $("#status_pendencia" + $(valor).attr('id')).focus(() => {
        if ($('#status_pendencia' + $(valor).attr('id')).val() == "") {
            $('#status_pendencia' + $(valor).attr('id')).val(`${formatarData(dia) + "/" + formatarData(mes) + "/" + formatarData(ano)} - ${$("#funcionario").html()}: `);
        }
    });

    $("#copiar" + $(valor).attr('id')).click(() => {
        $("#historico" + $(valor).attr('id')).val(
            $("#status_pendencia" + $(valor).attr('id')).val() + 
            "\n" + 
            $("#historico" + $(valor).attr('id')).val()
        );
        $("#status_pendencia" + $(valor).attr('id')).val("");
    });

    $("#expandir" + $(valor).attr('id')).click(() => {
        var mostrar = $(valor).attr('id') + "_mostrar"; //pega apenas o primeiro
        var display = $('#'+mostrar).css("display");

        if(display=='none'){
        $("#expandir" + $(valor).attr('id')).toggleClass('rodar');
        $('#'+mostrar).show('slow');
        } else {
        $("#expandir" + $(valor).attr('id')).toggleClass('rodar');
        $('#'+mostrar).hide('slow');
        }
    });
  });

  //Adicionando quantidade de tarefas em cada coluna
  $(".titulos").html(`
    <span title="Atrasada(s): ${aFazerAtrasada}\nAtenção: ${aFazerAviso}" class="titulo-child afazer">A fazer | ${aFazerAtrasada + aFazerAviso}</span>
    <span title="Adiantada(s): ${fazendoAdiantada}\nAtrasada(s): ${fazendoAtrasada}\nAtenção: ${fazendoAviso}" class="titulo-child fazendo">Fazendo | ${fazendoAdiantada + fazendoAtrasada + fazendoAviso}</span>
    <span title="Finalizada(s): ${feitoFinalizada}" class="titulo-child feito">Feito | ${feitoFinalizada}</span>`);

  $('.bt_editar').click(function(){
    localStorage.controller1 = 1;
    // $("#"+tarefa_id+"_modal").modal();
  });

  
});

function editarTarefa(id_tarefa){
    url = "{% url 'Tarefa:URL_editarTarefa' %}"
    window.open(url+id_tarefa);
}

function download(){
    var form = document.getElementById("form");
    form.setAttribute('action', '/tarefas/exportar/mae-filho')

    form.submit();

    form.setAttribute('action', '/tarefas/listar/')

}
</script>

<script>
    var dptoSelect = document.getElementById('id_id_departamento');

    var dpto_antigo = dptoSelect.options[dptoSelect.selectedIndex].text;
    var dpto_novo = dptoSelect.options[dptoSelect.selectedIndex].text;

    $(document).ready(function () {
        if (dptoSelect.options[dptoSelect.selectedIndex].text == "Obra") {
            $("#id_etapa").attr("required", "");
            document.getElementById("label-etapa").innerHTML = "*Etapa:";

            $("#id_subetapa").attr("required", "");
            document.getElementById("label-subetapa").innerHTML = "*SubEtapa:";
        }
    });

    function ControlDepartamento() {
        var dpto_novo = dptoSelect.options[dptoSelect.selectedIndex].text;

        if (dpto_antigo != dpto_novo) {
            dpto_antigo = dpto_novo;
            if (dpto_novo == 'Obra') {
                $("#id_etapa").attr("required", "");
                document.getElementById("label-etapa").innerHTML = "*Etapa:";

                $("#id_subetapa").attr("required", "");
                document.getElementById("label-subetapa").innerHTML = "*SubEtapa:";

            } else {
                $("#id_etapa").removeAttr("required");
                document.getElementById("label-etapa").innerHTML = "Etapa:";

                $("#id_subetapa").removeAttr("required");
                document.getElementById("label-subetapa").innerHTML = "SubEtapa:";
            }
        }

        setTimeout("ControlDepartamento()", 100)
    }
    ControlDepartamento()
</script>

<script>
    $(document).ready(function () {

    $("#id_id_update").val({{ usuario.id_pessoa }});
    $("#id_id_pessoa").val({{ usuario.id_pessoa }});
    $("#id_id_empresa").val({{ usuario.id_empresa }});

    });
</script>
{% endblock %}